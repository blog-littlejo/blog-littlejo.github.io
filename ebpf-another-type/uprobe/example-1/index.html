<!doctype html><html lang=fr dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="fr"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Observons une fonction simple de ton programme avec des uProbes &#183; Le blog de Little Jo</title><meta name=title content="Observons une fonction simple de ton programme avec des uProbes &#183; Le blog de Little Jo"><meta name=description content="Observons un petit programme Go avec des programmes eBPF de type u•Ret•Probe et avec Aya"><meta name=keywords content="Rust,eBPF,aya,uprobe,uretprobe,go,"><link rel=canonical href=https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/><link type=text/css rel=stylesheet href=/css/main.bundle.min.2bef69aa0d5bbd53f1fcc50836e6b87ebca45feb416b22a989d6f651ca847c2782a5a481fe2d49f05ee298ad615a9cb55b9682c0902a34b1f1bcd58d473c4385.css integrity="sha512-K+9pqg1bvVPx/MUINua4frykX+tBayKpidb2UcqEfCeCpaSB/i1J8F7imK1hWpy1W5aCwJAqNLHxvNWNRzxDhQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.98bb8ce8f123e03c4d2171eeec151dd404b5c476beb5ef1068d0e8b1a2afb923065e6552fc14b2d867c85ee4bd8529a43193f729f874d3908517ba03b5d1cc57.js integrity="sha512-mLuM6PEj4DxNIXHu7BUd1AS1xHa+te8QaNDosaKvuSMGXmVS/BSy2GfIXuS9hSmkMZP3Kfh005CFF7oDtdHMVw==" data-copy=Copier data-copied=Copié></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/"><meta property="og:site_name" content="Le blog de Little Jo"><meta property="og:title" content="Observons une fonction simple de ton programme avec des uProbes"><meta property="og:description" content="Observons un petit programme Go avec des programmes eBPF de type u•Ret•Probe et avec Aya"><meta property="og:locale" content="fr"><meta property="og:type" content="article"><meta property="article:section" content="ebpf-another-type"><meta property="article:published_time" content="2025-09-15T10:35:33+02:00"><meta property="article:modified_time" content="2025-09-15T10:35:33+02:00"><meta property="article:tag" content="Rust"><meta property="article:tag" content="EBPF"><meta property="article:tag" content="Aya"><meta property="article:tag" content="Uprobe"><meta property="article:tag" content="Uretprobe"><meta property="article:tag" content="Go"><meta property="og:image" content="https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/featured.webp"><meta property="og:see_also" content="https://blog.littlejo.link/ebpf-another-type/uprobe/example-2-tr/"><meta property="og:see_also" content="https://blog.littlejo.link/ebpf-another-type/uprobe/intro/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/featured.webp"><meta name=twitter:title content="Observons une fonction simple de ton programme avec des uProbes"><meta name=twitter:description content="Observons un petit programme Go avec des programmes eBPF de type u•Ret•Probe et avec Aya"><meta name=twitter:image content="https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/featured.webp"><meta property="og:image" content="https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/featured.webp"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Ebpf-Another-Types","name":"Observons une fonction simple de ton programme avec des uProbes","headline":"Observons une fonction simple de ton programme avec des uProbes","description":"Observons un petit programme Go avec des programmes eBPF de type u•Ret•Probe et avec Aya","abstract":"Observons un petit programme Go avec des programmes eBPF de type u•Ret•Probe et avec Aya","inLanguage":"fr","url":"https:\/\/blog.littlejo.link\/ebpf-another-type\/uprobe\/example-1\/","author":{"@type":"Person","name":"Joseph Ligier"},"copyrightYear":"2025","dateCreated":"2025-09-15T10:35:33\u002b02:00","datePublished":"2025-09-15T10:35:33\u002b02:00","dateModified":"2025-09-15T10:35:33\u002b02:00","keywords":["Rust","eBPF","aya","uprobe","uretprobe","go"],"mainEntityOfPage":"true","wordCount":"1847"}]</script><meta name=author content="Joseph Ligier"><link href=https://bsky.app/profile/littlejo.bsky.social rel=me><link href=https://www.linkedin.com/in/joseph-ligier-4b86632 rel=me><link href=https://dev.to/littlejo rel=me><link href=https://medium.com/@littel.jo rel=me><link href=https://github.com/littlejo rel=me><link href=https://ko-fi.com/littlejo rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><script data-goatcounter=https://littlejo-prd.goatcounter.com/count async src=/js/count.js></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
Aller au contenu</a></div><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Le blog de Little Jo</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/categories/introduction/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Introduction>Blog</p></a><div><div class="cursor-pointer flex items-center nested-menu"><span class="ltr:mr-1 rtl:ml-1"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Observons une fonction simple de ton programme avec des uProbes">FR</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/ebpf-another-type/uprobe/example-1/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Observons une fonction simple de ton programme avec des uProbes">FR</p></a><a href=/en/ebpf-another-type/uprobe/example-1/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Let’s Observe a Simple Function in Your Program with uProbes">EN</p></a></div></div></div></div><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Rechercher (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span><div><div class="cursor-pointer flex items-center nested-menu"><span class="ltr:mr-1 rtl:ml-1"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Observons une fonction simple de ton programme avec des uProbes">FR</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/ebpf-another-type/uprobe/example-1/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Observons une fonction simple de ton programme avec des uProbes">FR</p></a><a href=/en/ebpf-another-type/uprobe/example-1/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Let’s Observe a Simple Function in Your Program with uProbes">EN</p></a></div></div></div></div><button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Rechercher (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/categories/introduction/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Introduction>Blog</p></a></li></ul></div></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/ebpf-another-type/uprobe/example-1/featured_hu_d1e792c07a8e6c74.webp alt="Background Image" class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB+0SkNFs/NA==" data-target-id=background-blur data-image-id=background-image data-image-url=/ebpf-another-type/uprobe/example-1/featured.webp></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Le blog de Little Jo</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/ebpf-another-type/>Ebpf-Another-Types</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/ebpf-another-type/uprobe/example-1/>Observons une fonction simple de ton programme avec des uProbes</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Observons une fonction simple de ton programme avec des uProbes</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-09-15T10:35:33+02:00>15 septembre 2025</time><span class="px-2 text-primary-500">&#183;</span><span>1847 mots</span><span class="px-2 text-primary-500">&#183;</span><span title="Temps de lecture">9 mins</span><span class="px-2 text-primary-500">&#183;</span>
<script type=text/javascript src=/js/zen-mode.min.9814dee9614d32aeb56239d118edfe20acd6231424f9b19c2dd48835038414130a5e946c0d1c9087d60e60e31840c9babfd217e3d4b95643dc8d651a71ccdf4a.js integrity="sha512-mBTe6WFNMq61YjnRGO3+IKzWIxQk+bGcLdSINQOEFBMKXpRsDRyQh9YOYOMYQMm6v9IX49S5VkPcjWUacczfSg=="></script><span class=mb-[2px]><span id=zen-mode-button class="text-lg hover:text-primary-500" title="Activer le mode zen" data-title-i18n-disable="Activer le mode zen" data-title-i18n-enable="Désactiver le mode zen"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt="Joseph Ligier" src=/img/littlejo_hu_4250d52962eec5b0.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Auteur</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Joseph Ligier</div><div class="text-sm text-neutral-700 dark:text-neutral-400">CNCF ambassador | Kubestronaut 🐝</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://bsky.app/profile/littlejo.bsky.social target=_blank aria-label=Bluesky rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/joseph-ligier-4b86632 target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://dev.to/littlejo target=_blank aria-label=Dev rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88.0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59.0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21.0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44.0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44.0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://medium.com/@littel.jo target=_blank aria-label=Medium rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M180.5 74.262C80.813 74.262.0 155.633.0 256S80.819 437.738 180.5 437.738 361 356.373 361 256 280.191 74.262 180.5 74.262zm288.25 10.646c-49.845.0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559C559 161.5 518.6 84.908 468.752 84.908zm139.506 17.821c-17.526.0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/littlejo target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://ko-fi.com/littlejo target=_blank aria-label=Ko-Fi rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg width="211.67mm" height="211.67mm" viewBox="0 0 211.67 211.67"><defs><clipPath id="clipPath25"><path d="m0 6e2h1654.8V0H0z" fill="currentColor"/></clipPath></defs><g transform="translate(-3.0786 -29.59)"><g transform="matrix(.35278 0 0 -.35278 3.0785 241.26)"><g clip-path="url(#clipPath25)"><g transform="translate(600 300)"><path d="m-3e2 3e2c-165.69.0-3e2-134.31-3e2-3e2s134.31-3e2 3e2-3e2C-134.32-3e2.0-165.69.0.0s-134.32 3e2-3e2 3e2zm-188.93-166.99h329.58c23.223.0 46.032-6.8325 65.073-20.125 18.412-12.856 36.378-33.646 42.697-67.02 14.674-77.514-43.568-135.76-126.12-131.18.438-21.268-3.8105-59.422-44.878-69.696-3.282-.821-6.6604-1.186-10.044-1.207-72.13-.448-222.53-.88916-222.53-.88916s-46.066-.01555-49.176 45.962c-1.023 77.88-.48339 223.69-.48339 223.69s-.02651 2.9267-.02051 3.6577c.043 5.607 4.4359 16.8 15.901 16.8zm312.71-55.573v-107.8s14.302-1.6507 31.907.54932c20.356 6.6 39.06 20.901 39.06 57.199.0 14.85-5.2614 25.601-11.837 33.239-9.341 10.848-23.152 16.809-37.469 16.809h-21.661z" fill="currentColor"/></g><g transform="translate(256.61 203.37)"><path d="m0 0c3.585-1.806 5.876.437 5.876.437s52.457 47.878 76.089 75.452c21.018 24.667 22.389 66.234-13.708 81.766-36.096 15.532-65.795-18.272-65.795-18.272-25.755 28.326-64.734 26.891-82.763 7.721-18.027-19.169-11.732-52.072 1.717-70.383 12.626-17.19 68.119-66.65 76.529-75.015.0.0.614-.641 2.055-1.706" fill="currentColor"/></g></g></g></g></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Sommaire</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#créons-un-programme-pour-tester-les-uprobes>Créons un programme pour tester les uProbes</a><ul><li><a href=#un-code-tout-simple>Un code tout simple</a></li><li><a href=#comment-va-t-on-activer-des-uprobes->Comment va-t-on activer des uProbes ?</a></li><li><a href=#compilons-le-programme>Compilons le programme</a></li></ul></li><li><a href=#comment-trouver-le-point-dattache->Comment trouver le point d&rsquo;attache ?</a><ul><li><a href=#nom-du-binaire>Nom du binaire</a></li><li><a href=#nom-de-la-fonction>Nom de la fonction</a></li></ul></li><li><a href=#créons-un-programme-ebpf-de-type-uprobe>Créons un programme eBPF de type uProbe</a><ul><li><a href=#testons-avec-bpftrace>Testons avec bpftrace</a></li><li><a href=#génération-du-programme-aya>Génération du programme Aya</a></li><li><a href=#compilation-et-installation-dans-le-noyau>Compilation et installation dans le noyau</a></li><li><a href=#testons-maintenant>Testons maintenant</a></li></ul></li><li><a href=#créons-un-programme-ebpf-de-type-uretprobe>Créons un programme eBPF de type uRetProbe</a><ul><li><a href=#testons-avec-bpftrace-1>Testons avec bpftrace</a></li><li><a href=#génération-du-programme-aya-1>Génération du programme Aya</a></li><li><a href=#compilation-et-installation>Compilation et installation</a></li><li><a href=#modification-du-code>Modification du code</a></li><li><a href=#testons-maintenant-1>Testons maintenant</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Sommaire</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#créons-un-programme-pour-tester-les-uprobes>Créons un programme pour tester les uProbes</a><ul><li><a href=#un-code-tout-simple>Un code tout simple</a></li><li><a href=#comment-va-t-on-activer-des-uprobes->Comment va-t-on activer des uProbes ?</a></li><li><a href=#compilons-le-programme>Compilons le programme</a></li></ul></li><li><a href=#comment-trouver-le-point-dattache->Comment trouver le point d&rsquo;attache ?</a><ul><li><a href=#nom-du-binaire>Nom du binaire</a></li><li><a href=#nom-de-la-fonction>Nom de la fonction</a></li></ul></li><li><a href=#créons-un-programme-ebpf-de-type-uprobe>Créons un programme eBPF de type uProbe</a><ul><li><a href=#testons-avec-bpftrace>Testons avec bpftrace</a></li><li><a href=#génération-du-programme-aya>Génération du programme Aya</a></li><li><a href=#compilation-et-installation-dans-le-noyau>Compilation et installation dans le noyau</a></li><li><a href=#testons-maintenant>Testons maintenant</a></li></ul></li><li><a href=#créons-un-programme-ebpf-de-type-uretprobe>Créons un programme eBPF de type uRetProbe</a><ul><li><a href=#testons-avec-bpftrace-1>Testons avec bpftrace</a></li><li><a href=#génération-du-programme-aya-1>Génération du programme Aya</a></li><li><a href=#compilation-et-installation>Compilation et installation</a></li><li><a href=#modification-du-code>Modification du code</a></li><li><a href=#testons-maintenant-1>Testons maintenant</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const n=.33,s="#TableOfContents",o=".anchor",i='a[href^="#"]',a="li ul",r="active";function c(e,t){const s=window.scrollY+window.innerHeight*t,o=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],n=new Set(o.map(e=>e.getAttribute("href").substring(1)));for(let t=e.length-1;t>=0;t--){const o=e[t].getBoundingClientRect().top+window.scrollY;if(o<=s&&n.has(e[t].id))return e[t].id}return e.find(e=>n.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=c(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(r,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function t(){const t=document.querySelector(s);if(!t)return;const c=!1,l=[...document.querySelectorAll(o)],d=[...t.querySelectorAll(i)];c&&t.querySelectorAll(a).forEach(e=>e.style.display="none");const r={toc:t,anchors:l,links:d,scrollOffset:n,collapseInactive:c};window.addEventListener("scroll",()=>e(r),{passive:!0}),window.addEventListener("hashchange",()=>e(r),{passive:!0}),e(r)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><details class="mt-2 mb-5 overflow-hidden rounded-lg ltr:ml-0 ltr:pl-5 rtl:mr-0 rtl:pr-5" open><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">Apprenons uProbe avec eBPF et Aya -
Cet article fait partie d'une série.</summary><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/ebpf-another-type/uprobe/intro/>Partie 1:
L’observabilité pour tous les développeurs avec les uProbes</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">Partie 2:
Cet article</div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/ebpf-another-type/uprobe/example-2-tr/>Partie 3:
Sondons une bibliothèque avec une uProbe</a></div></details><div class="article-content max-w-prose mb-20"><p>Nous avons vu ce qu&rsquo;était un programme de type uProbe dans <a href=/ebpf-another-type/uprobe/intro/>la première partie</a> : un moyen de sonder les fonctions de vos programmes.</p><p>Dans cette partie, nous allons d&rsquo;abord créer un programme très simple en Go et nous allons le faire réagir avec deux programmes eBPF :</p><ul><li>Le premier de type uProbe</li><li>Le deuxième de type uRetProbe</li></ul><div class="flex px-4 py-3 rounded-md
alert-tip"><span class="ltr:pr-3 rtl:pl-3 flex items-center
alert-icon-tip"><span class="relative block icon"><!doctype html><svg height="800" width="800" id="_x32_" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512"><style>.st0{fill:currentColor}</style><g><path class="st0" d="M485.235 281.91l-44.273-25.356-65.345 8.26c-1.168-4.886-2.55-9.608-4.173-14.099l46.634-18.049 27.349-47.596-2.954-23.279c18.874-15.396 31.677-45.767 16.762-78.388-18.024-39.422-54.964-47.27-54.964-47.27l2.07 70.755-56.364-28.259c-5.169 72.541 40.787 95.467 69.029 93.252l1.031 8.098-18.917 32.912-40.512 15.688c-13.516-20.728-36.811-43.303-38.589-58.287 5.144-4.336 8.407-10.82 8.407-18.075.0-13.051-10.578-23.631-23.63-23.631s-23.64 10.58-23.64 23.631c0 6.475 2.611 12.34 6.818 16.607-7.007 10.501-6.414 17.723-33.978 17.723-27.555.0-26.97-7.222-33.977-17.723 4.216-4.267 6.826-10.132 6.826-16.607.0-13.051-10.588-23.631-23.648-23.631-13.052.0-23.622 10.58-23.622 23.631.0 7.256 3.263 13.739 8.406 18.075-1.777 14.984-25.073 37.558-38.588 58.287l-40.521-15.688-18.9-32.912 1.022-8.098c28.242 2.215 74.198-20.711 69.021-93.252l-56.364 28.259 2.078-70.755s-36.948 7.849-54.963 47.27c-14.924 32.62-2.113 62.992 16.752 78.388l-2.954 23.279 27.348 47.596 46.635 18.049c-1.606 4.491-2.998 9.213-4.174 14.099l-65.336-8.26L26.756 281.91.0 327.935l15.353 10.158 28.671-37.773 32.088-18.376 56.596 7.162c-.293 4.259-.404 8.518-.301 12.786l-40.71 13.567L52.216 362.84l-6.414 60.279 18.195 2.868 11.42-52.628 30.672-36.811 29.478-9.832c2.216 9.223 5.634 17.929 10.45 25.64l-27.624 19.174-11.867 51.546 15.903 52.791 17.774-4.808-8.569-49.176 9.247-36.064 20.574-14.28c34.467 33.874 81.737 33.643 94.539 33.643 12.812.0 60.073.231 94.549-33.643l20.574 14.28 9.239 36.064-8.56 49.176 17.774 4.808 15.903-52.791-11.876-51.546-27.632-19.174c4.826-7.711 8.244-16.418 10.458-25.64l29.479 9.832 30.68 36.811 11.412 52.628 18.195-2.868-6.414-60.279-39.482-47.381-40.71-13.567c.112-4.267-.009-8.526-.292-12.786l56.595-7.162 32.081 18.376 28.67 37.773L512 327.935 485.235 281.91z"/></g></svg>
</span></span><span class=dark:text-neutral-300><p>Je suppose que vous êtes déjà dans un <a href=https://aya-rs.dev/book/start/development/ target=_blank>environnement pour développer avec Aya</a> et que vous avez installé le compilateur <a href=https://go.dev/doc/install target=_blank>go</a> et <a href=https://github.com/bpftrace/bpftrace/blob/master/INSTALL.md target=_blank>bpftrace</a>.
Si ce n&rsquo;est pas le cas, vous pouvez utiliser le lab Killercoda :</p><p><a href=https://killercoda.com/littlejo/course/aya-prod/aya-uprobe target=_blank><figure><img class="my-0 rounded-md" loading=lazy alt="Killer coda screenshot" src=https://blog.littlejo.link/assets/screenshot/uprobe/uprobe-killercoda.webp></figure></a></p></span></div><hr><h2 class="relative group">Créons un programme pour tester les uProbes<div id=créons-un-programme-pour-tester-les-uprobes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#cr%c3%a9ons-un-programme-pour-tester-les-uprobes aria-label=Ancre>#</a></span></h2><h3 class="relative group">Un code tout simple<div id=un-code-tout-simple class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#un-code-tout-simple aria-label=Ancre>#</a></span></h3><p>Pour changer du Rust, nous allons créer un petit programme en Go :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// hello.go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>hello</span><span class=p>()</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Hello, world!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>ret</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>hello</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Returned:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>ret</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><div class="flex px-4 py-3 rounded-md
alert-info"><span class="ltr:pr-3 rtl:pl-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="128" height="128" viewBox="0 0 24 24"><g fill="none"><path fill="currentColor" d="M21.4679537 3.20617761C22.1814672 4.67953668 20.0131274 4.83706564 20.1243243 5.49498069 20.3281853 6.68108108 20.1891892 8.44169884 20.0316602 10.1745174 19.7629344 13.1119691 21.9590734 20.1451737 17.3814672 22.9714286 16.5196911 23.5088803 14.4718147 23.8054054 12.4517375 23.8517375H12.442471s-.00926639999999956.0-.00926639999999956.0C10.4131274 23.8054054 8.08725869 23.5088803 7.22548263 22.9714286c-4.56833977-2.8262549-2.37220078-9.8594595-2.63166024-12.7969112C4.42702703 8.44169884 4.28803089 6.68108108 4.5011583 5.49498069 4.61235521 4.83706564 2.44401544 4.68880309 3.15752896 3.20617761c.61158301-1.26949807 2.12200772-.14826255 2.5019305-.54671815C7.596139.648648649 9.94980695.111196911 11.8030888.0648648649c.185328200000001.0 1.019305.0 1.019305.0C14.6664093.157528958 17.0200772.657915058 18.9660232 2.65945946c.379922700000002.3984556 1.881081-.72277992 2.5019305.54671815zM11.4324324 10.9065637C11.3490347 10.9436293 11.2100386 11.8517375 11.6362934 11.8980695 11.9235521 11.9258687 12.7111969 12.0185328 12.8965251 11.8980695 13.2579151 11.6664093 13.2208494 11.1104247 13.0169884 10.9714286 12.6741313 10.7490347 11.5250965 10.8602317 11.4324324 10.9065637zM9.07876448 4.10501931C8.12432432 3.99382239 6.52123552 4.88339768 6.28030888 6.77374517 6.02084942 8.73822394 8.33745174 10.6841699 10.56139 8.73822394c1.1953668-1.04710425 1.6123552-4.27181467-1.48262552-4.63320463zm6.44942082.0C12.4332046 4.46640927 12.8501931 7.69111969 14.0455598 8.73822394c2.2239383 1.94594596 4.5405406.0 4.2810811-1.96447877-.2316602-1.89034749-1.834749-2.77992278-2.7984556-2.66872586z" style=""/><path fill="#000" d="M12.3127413 8.98841699C12.8965251 8.90501931 14.2957529 9.57220077 14.2030888 10.3598456 14.0918919 11.2772201 10.5984556 11.3976834 10.4131274 10.3042471 10.3019305 9.63706564 10.8301158 9.21081081 12.3127413 8.98841699zm7.8857143 7.38532821C19.9111969 16.3644788 19.7258687 15.984556 19.7258687 15.7528958 19.7258687 15.3359073 19.7814672 14.8447876 20.0872587 14.6316602 20.7173745 14.196139 21.2177606 16.3830116 20.1984556 16.3737452zm-15.78069498.0C3.3984556 16.3830116 3.8988417 14.196139 4.52895753 14.6316602 4.83474903 14.8447876 4.89034749 15.3359073 4.89034749 15.7528958c0 .2316602-.18532818.611583000000001-.47258687.620849399999999zM18.2617761 23.0918919C18.4471042 23.3606178 18.4563707 23.5459459 18.1598456 23.6849421 17.0293436 24.203861 16.019305 23.5088803 16.3992278 23.3142857 17.2054054 22.9065637 17.7057915 22.2671815 18.2617761 23.0918919zM6.35444015 23.184556C6.91042471 22.3598456 7.41081081 22.9992278 8.21698842 23.4069498 8.5969112 23.6015444 7.58687259 24.2965251 6.45637066 23.7776062 6.15984556 23.63861 6.16911197 23.4532819 6.35444015 23.184556z" style=""/><path fill="currentColor" d="M19.7351351 3.42857143C19.7814672 3.23397683 20.2633205 3.14131274 20.5320463 3.47490347 20.8563707 3.87335907 20.0594595 4.42007722 20.0223938 4.1976834 19.9297297 3.5953668 19.6795367 3.62316602 19.7351351 3.42857143zm-14.85405402.0C4.93667954 3.62316602 4.68648649 3.5953668 4.59382239 4.1976834 4.55675676 4.42007722 3.75984556 3.87335907 4.08416988 3.47490347c.25945946-.33359073.74131275-.24092664.7969112-.0463320400000002zM15.7413127 7.94131274c-.5834174.0-1.0563706-.47295325-1.0563706-1.05637066.0-.5834174.472953199999999-1.05637065 1.0563706-1.05637065s1.0563707.47295325 1.0563707 1.05637065c0 .58341741-.4729533 1.05637066-1.0563707 1.05637066zm-.2779922-1.17683398c.184237.0.3335907-.14935365.3335907-.33359073.0-.18423707-.149353700000001-.33359073-.3335907-.33359073-.184237100000001.0-.3335908.14935366-.3335908.33359073.0.18423708.149353699999999.33359073.3335908.33359073zM11.3583012 9.43320463C11.4694981 9.00694981 11.8586873 8.86795367 12.1737452 8.85868726 12.9799228 8.84015444 13.2857143 9.27567568 13.3135135 9.61853282 13.369112 10.2023166 11.1081081 10.3413127 11.3583012 9.43320463zM8.87490347 7.94131274c-.5834174.0-1.05637065-.47295325-1.05637065-1.05637066.0-.5834174.47295325-1.05637065 1.05637065-1.05637065.583417410000001.0 1.05637066.47295325 1.05637066 1.05637065.0.58341741-.47295325 1.05637066-1.05637066 1.05637066zM9.15289575 6.76447876c.184237079999999.0.33359074-.14935365.33359074-.33359073.0-.18423707-.149353660000001-.33359073-.33359074-.33359073-.18423707.0-.333590730000001.14935366-.333590730000001.33359073.0.18423708.149353660000001.33359073.333590730000001.33359073z" style=""/></g></svg>
</span></span><span class=dark:text-neutral-300>Vous pouvez tester pour un autre programme compilé comme C/C++ ou Rust si vous préférez.</span></div><h3 class="relative group">Comment va-t-on activer des uProbes ?<div id=comment-va-t-on-activer-des-uprobes- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#comment-va-t-on-activer-des-uprobes- aria-label=Ancre>#</a></span></h3><p>Le but de l&rsquo;article est d&rsquo;activer :</p><ul><li>un programme eBPF de type uProbe à chaque fois que l&rsquo;on rentre dans la fonction <code>hello()</code> :</li></ul><p><figure><img class="my-0 rounded-md" loading=lazy alt="Go uprobe" src=https://blog.littlejo.link/assets/svg/uprobe/go-uprobe.svg></figure></p><ul><li>un programme eBPF de type uRetProbe à chaque fois que l&rsquo;on sort de la fonction <code>hello()</code> :</li></ul><p><figure><img class="my-0 rounded-md" loading=lazy alt="Go uretprobe" src=https://blog.littlejo.link/assets/svg/uprobe/go-uretprobe.svg></figure></p><p>Maintenant qu&rsquo;on a vu les tenants et les aboutissants de l&rsquo;article, passons à la compilation du programme.</p><h3 class="relative group">Compilons le programme<div id=compilons-le-programme class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#compilons-le-programme aria-label=Ancre>#</a></span></h3><p>Pour le compiler, il suffit de taper :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>go</span> build <span class=na>-gcflags</span><span class=o>=</span><span class=s2>&#34;all=-N -l&#34;</span> <span class=na>-o</span> hello hello.go
</span></span></code></pre></div><p>On peut remarquer qu&rsquo;on a ajouté une option <code>-gcflags="all=-N -l"</code>. Normalement, on <strong>n&rsquo;a pas besoin</strong> d&rsquo;utiliser cette option pour compiler un programme Go :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>go</span> build <span class=na>-o</span> hello hello.go
</span></span></code></pre></div><p>Cela fonctionne également. Mais alors pourquoi utiliser cette option ?</p><ul><li><code>-gcflags</code> veut dire <em><strong>g</strong>o <strong>c</strong>ompiler <strong>flags</strong></em> ce sont des options passées au compilateur Go.</li><li><code>all</code> permet de dire que les options s&rsquo;appliquent à tous les packages compilés.</li></ul><p>Les options spécifiées au compilateur Go sont :</p><ul><li><code>-N</code> : par défaut, le compilateur modifie (<em>mangle</em>) le nom de la fonction. Cette option permet de désactiver cette modification.</li></ul><div class="flex px-4 py-3 rounded-md
alert-info"><span class="ltr:pr-3 rtl:pl-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span>
</span><span class=dark:text-neutral-300>En anglais, <em>to mangle</em> peut se traduire par modifier, mutiler ou même défigurer. En informatique, <em>name mangling</em> se traduit par <a href=https://fr.wikipedia.org/wiki/D%C3%A9coration_de_nom target=_blank>décoration de nom</a>. On a complètement gommé le côté péjoratif du terme !</span></div><ul><li><code>-l</code> : par défaut, le compilateur <em>inline</em> les fonctions c&rsquo;est à dire qu&rsquo;elle intègre directement le contenu de la fonction dans le code appelant permettant
ainsi aux programmes d&rsquo;être plus performants. Cette option permet de désactiver cet <em>inline</em>.</li></ul><p><figure><img class="my-0 rounded-md" loading=lazy alt="Go inline" src=https://blog.littlejo.link/assets/svg/uprobe/go-inline.svg></figure></p><p>Ainsi ces options vont nous permettre de garder les fonctions et de les rendre lisible, ce qui va nous simplifier pour trouver le point d&rsquo;attache pour notre programme eBPF.</p><hr><h2 class="relative group">Comment trouver le point d&rsquo;attache ?<div id=comment-trouver-le-point-dattache- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#comment-trouver-le-point-dattache- aria-label=Ancre>#</a></span></h2><p>Maintenant qu&rsquo;on a créé et compilé le petit programme, il faut trouver comment déclencher le programme eBPF de type uProbe ou uRetProbe. Lorsqu&rsquo;on utilise <code>cargo generate</code> pour le repo aya, il faut répondre à deux questions : où se trouve le nom du binaire et quelle fonction observée. Voyons cela en détail.</p><h3 class="relative group">Nom du binaire<div id=nom-du-binaire class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#nom-du-binaire aria-label=Ancre>#</a></span></h3><pre tabindex=0><code>🤷   Target to attach the (u|uret)probe? (e.g libc):
</code></pre><p>Pour garantir la portabilité du programme eBPF, il faut répondre le chemin absolu du binaire. Par exemple je l&rsquo;ai créé là : <code>/home/cloud_user/hello</code>.</p><h3 class="relative group">Nom de la fonction<div id=nom-de-la-fonction class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#nom-de-la-fonction aria-label=Ancre>#</a></span></h3><p>Une fois que tu as répondu à la première question, il reste une seconde question :</p><pre tabindex=0><code>🤷   Function name to attach the (u|uret)probe? (e.g getaddrinfo):
</code></pre><p>Que faut-il répondre ? On serait tenté de répondre <code>hello</code> vu qu&rsquo;on a mis l&rsquo;option <code>-N</code> qui désactive la décoration de nom lors de la compilation.</p><p>Mais c&rsquo;est un peu plus compliqué. Le compilateur Go modifie tout de même légèrement le nom de la fonction pendant l&rsquo;étape de compilation.</p><p>Nous l&rsquo;avons vu dans le précédent épisode pour trouver toutes les fonctions d&rsquo;un binaire, il suffit d&rsquo;utiliser <code>bpftrace</code> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fish data-lang=fish><span class=line><span class=cl><span class=nf>bpftrace</span> <span class=na>-l</span> <span class=s1>&#39;uprobe:/home/cloud_user/hello:*&#39;</span>
</span></span></code></pre></div><ul><li>l&rsquo;option <code>-l</code> permet de lister toutes les <em>probes</em> disponibles</li><li><code>uprobe</code> : le type de programme eBPF</li><li><code>/home/cloud_user/hello</code> : l&rsquo;emplacement du binaire</li><li><code>*</code> : le joker (0 ou plusieurs caractères)</li></ul><p>Le format d&rsquo;affichage est alors :</p><pre tabindex=0><code>uprobe:/home/cloud_user/hello:[fonction1]
uprobe:/home/cloud_user/hello:[fonction2]
uprobe:/home/cloud_user/hello:[fonction3]
uprobe:/home/cloud_user/hello:[fonction4]
etc 
</code></pre><p>C&rsquo;est pas de bol : le nom de la fonction est le même que le nom de mon fichier&mldr; On ne peut pas faire de <code>| grep hello</code>. Comment s&rsquo;en sortir ? avec <code>awk</code>, <code>cut</code> ou pire une regex ?
Faisons simple :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fish data-lang=fish><span class=line><span class=cl><span class=nf>bpftrace</span> <span class=na>-l</span> <span class=s1>&#39;uprobe:/home/cloud_user/hello:*hello*&#39;</span>
</span></span></code></pre></div><p>Et ça va vous répondre :</p><pre tabindex=0><code>uprobe:/home/cloud_user/hello:main.hello
</code></pre><p>Ainsi le nom réel de la fonction est <code>main.hello</code></p><div class="flex px-4 py-3 rounded-md
alert-tip"><span class="ltr:pr-3 rtl:pl-3 flex items-center
alert-icon-tip"><span class="relative block icon"><svg id="a" viewBox="0 0 58.530809 60.557009" width="58.530807" height="60.557011"><path d="m57.75 8.16701c-.59-.44-1.33-.55-2.05-.6-4.36-.28-8.74 1.67-11.44 5.08-.43.54-.93 1.06-1.42.89-.5-.17-.55-.94-.54-1.59.06-4.38-2.25-8.8-5.87-11.24999999-.62-.42-1.63-.84-2.47-.65-.4.1-.73.33-.93.68C32.24 2.10701 34.05 3.41701 34.82 3.96701c2.39 1.73 3.94 4.64 4.05 7.59.0.22.0.43-.09.58-.16.25-.53.29-.9.33h-.09c-2.16.23-4.17 1.54-5.25 3.44-1.01 1.8-1.15 4.04-.38 5.95-6.64.62-13.49 1.76-18.83 5.59-1.83 1.31-3.11 2.75-3.8 4.28-.22.48-.38.96-.48 1.49-.45 2.28.43 4.78 2.25 6.37 1.75 1.51 4.28 2.12 6.61 1.58l.33-.08c.78-.2 1.59-.4 2.17.0.47.32.65.95.81 1.61l3.63 14.65c.25 1.01.71 2.39 1.89 2.65.14.03.27.05.4.05.77.0 1.49-.5 2.12-.99l11.46-8.99c.69-.55 1.43-1.07 2.21-.97.79.1 1.33.78 1.89 1.51.14.18.28.36.42.52 1.67 2 4.48 2.93 7.01 2.33 1.29-.31 2.48-1 3.44-2.01 1.04-1.08 1.68-2.34 1.79-3.47.1-1.28-.01-2.69-.33-4.2-.52-2.56-1.61-5.14-3.23-7.69-2.23-3.5-5.16-6.48-8.02-9.36 1.82-1 3.13-2.84 3.47-4.88.35-2.17-.4-4.46-1.98-6-.27-.26-.58-.56-.54-.86.02-.16.15-.31.28-.45 2.06-2.32 5.25-3.63 8.35-3.41.95.07 2.4.18 2.91-.88.37-.73-.04-1.63-.64-2.08zm-20.25 20.39.15.06.02-.02c2.33.9 4.04 3.14 4.68 6.17.06.24-.02.49-.21.66-.18.17-.44.23-.68.16-1.81-.51-3.75-1.13-5.76-1.84h-.07c-2.06-.76-3.9-1.48-5.6-2.21-.23-.09-.39-.3-.42-.55-.04-.25.06-.49.25-.64 2.46-1.99 5.25-2.63 7.64-1.79zm-13.31 2.93-.05.05c-.32.48-.63 1-.93 1.5-.92 1.54-1.88 3.14-3.38 4.05-1.34.81-3.01 1.01-4.6.56-1.09-.32-1.97-.92-2.45-1.69-.48-.77-.58-1.59-.3-2.43.83-2.43 4.81-4.69 7.13-5.55 2.11-.79 4.37-1.26 6.55-1.72.69-.15 1.37-.29 2.05-.44l.18-.04c.99-.23 2.01-.46 3.01-.46.02.0.05.0.07.01-2.19.95-4.2 2.41-5.85 4.29-.56.63-1.05 1.27-1.43 1.87zm13.89 16.45c-2.04 1.82-4.35 3.19-5.97 4.03-.79-.41-1.6-.77-2.4-1.05-.82-.29-1.68-.53-2.71-.74-.73-1.67-1.67-4.19-2.11-6.92-.02-.15.07-.24.11-.27s.15-.1.3-.03c2.07.88 4.16 1.71 6.23 2.45h.07c2.03.74 4.17 1.42 6.35 2.03.16.05.2.17.22.23.01.05.02.17-.09.27zm4.33-7.56c-.12.79-.35 1.64-.69 2.6-.08.25-.19.52-.31.77-.23.5-.82.77-1.36.63h-.04c-2.34-.63-4.78-1.39-7.27-2.27l-.07-.02c-2.52-.9-4.9-1.85-7.05-2.83-.51-.23-.79-.81-.66-1.35.05-.24.13-.51.24-.78.33-.94.69-1.74 1.11-2.46.23-.43.75-.61 1.2-.4 2.24 1 4.6 1.93 7 2.78h.07c2.39.87 4.79 1.63 7.15 2.26.48.13.78.59.68 1.07zm4-8.18.08.11c.42.54.86 1.07 1.29 1.6 1.41 1.75 2.88 3.55 4.03 5.51.9 1.53 3.03 6.1 2.03 8.8-.31.83-.9 1.4-1.76 1.69-.87.3-1.92.22-2.97-.23-1.49-.64-2.69-1.88-3.21-3.33-.6-1.67-.33-3.52-.08-5.31.09-.58.17-1.16.22-1.74.08-.73.1-1.51.06-2.4-.1-2.5-.73-4.91-1.85-7.04.82.64 1.5 1.5 2.16 2.34zm-.52-11.58c-.19 1.81-1.66 3.58-3.5 4.22l-.2.06c-1.77.55-3.61.22-4.96-.89-1.67-1.38-2.36-3.88-1.64-5.96.64-1.83 2.03-2.36 3.44-2.36.97.0 1.95.25 2.69.51 1.92.66 4.43 1.84 4.17 4.42zm-35.71 33.98h8.71c.97.0 1.76-.79 1.76-1.76s-.79-1.75-1.76-1.75h-8.71c-.97.0-1.76.79-1.76 1.75s.79 1.76 1.76 1.76zm11.69 2.45H1.75c-.97.0-1.75.79-1.75 1.76s.78 1.75 1.75 1.75h20.12c.96.0 1.75-.79 1.75-1.75s-.79-1.76-1.75-1.76z" style="fill:currentColor" id="path9"/></svg>
</span></span><span class=dark:text-neutral-300>Si vous ne pouvez pas installer bpftrace, vous pouvez utiliser la commande <code>nm</code>. Elle permet de voir tous les symboles qui sont présents dans un fichier binaire.</span></div><p>Maintenant qu&rsquo;on a la réponse aux deux questions, nous pouvons créer nos programmes eBPF.</p><p>Commençons par le programme de type uProbe.</p><hr><h2 class="relative group">Créons un programme eBPF de type uProbe<div id=créons-un-programme-ebpf-de-type-uprobe class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#cr%c3%a9ons-un-programme-ebpf-de-type-uprobe aria-label=Ancre>#</a></span></h2><p><figure><img class="my-0 rounded-md" loading=lazy alt="Go uprobe" src=https://blog.littlejo.link/assets/svg/uprobe/go-uprobe.svg></figure></p><h3 class="relative group">Testons avec bpftrace<div id=testons-avec-bpftrace class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#testons-avec-bpftrace aria-label=Ancre>#</a></span></h3><p>Avant de foncer tête baissée sur un programme Aya, vérifions que ça fonctionne bien avec <code>bpftrace</code>, le programme qui crée en une ligne de commande un programme eBPF. Ça tombe bien : on a déjà trouvé le début dans la section précédente :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>uprobe:/home/cloud_user/hello:main.hello
</span></span></code></pre></div><p>Il reste plus qu&rsquo;à compléter par un <em>hello world</em> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>sudo</span> <span class=nf>bpftrace</span> <span class=na>-e</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>&#39;uprobe:/home/cloud_user/hello:main.hello { printf(&#34;Hello go\n&#34;); }&#39;</span>
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md
alert-warning"><span class="ltr:pr-3 rtl:pl-3 flex items-center
alert-icon-warning"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 0c4.6.0 9.2 1 13.4 2.9L457.7 82.8c22 9.3 38.4 31 38.3 57.2-.5 99.2-41.3 280.7-213.7 363.2-16.7 8-36.1 8-52.8.0C57.3 420.7 16.5 239.2 16 140c-.1-26.2 16.3-47.9 38.3-57.2L242.7 2.9C246.8 1 251.4.0 256 0zm0 66.8v378C394 378 431.1 230.1 432 141.4L256 66.8z"/></svg></span>
</span><span class=dark:text-neutral-300>Historiquement, il fallait avoir les droits <em>root</em> pour installer un programme eBPF dans le noyau. Avec un Linux moderne, un utilisateur non <em>root</em> peut installer un programme eBPF avec juste quelques capacités supplémentaires comme <code>CAP_BPF</code>. Cependant bpftrace ne gère pas cela : il faut être en root.</span></div><p>Dans un autre terminal, lançons alors le programme <code>hello</code> (sans les droits <em>root</em>) :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl>./hello
</span></span></code></pre></div><p>Sur le terminal où est lancé <em>bpftrace</em>, vous voyez <code>Hello go</code> à chaque fois que vous lancez le programme <code>hello</code>.</p><p>Verifions qu&rsquo;on peut créer un programme similaire avec Aya.</p><h3 class="relative group">Génération du programme Aya<div id=génération-du-programme-aya class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#g%c3%a9n%c3%a9ration-du-programme-aya aria-label=Ancre>#</a></span></h3><p>Définissons déjà les différentes réponses pour le point d&rsquo;attache dans des variables, pour mon cas ça sera :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nv>target</span><span class=o>=</span>/home/cloud_user/hello
</span></span><span class=line><span class=cl><span class=nv>fn_name</span><span class=o>=</span>main.hello
</span></span></code></pre></div><p>Lançons maintenant la commande pour générer le programme Aya :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>cargo</span> generate <span class=na>--name</span> test-uprobe <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               <span class=na>-d</span> <span class=nv>program_type</span><span class=o>=</span>uprobe <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               <span class=na>-d</span> <span class=nv>uprobe_target</span><span class=o>=</span><span class=nv>$target</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               <span class=na>-d</span> <span class=nv>uprobe_fn_name</span><span class=o>=</span><span class=nv>$fn_name</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               <span class=nf>https</span>://github.com/aya-rs/aya-template
</span></span></code></pre></div><p>Sans les options qu&rsquo;on lui a indiqué, <code>cargo generate</code> fonctionnerait <strong>en mode interactif</strong> : on devrait répondre à des questions.</p><div class="flex px-4 py-3 rounded-md
alert-tip"><span class="ltr:pr-3 rtl:pl-3 flex items-center
alert-icon-tip"><span class="relative block icon"><!doctype html><svg height="800" width="800" id="_x32_" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512"><style>.st0{fill:currentColor}</style><g><path class="st0" d="M485.235 281.91l-44.273-25.356-65.345 8.26c-1.168-4.886-2.55-9.608-4.173-14.099l46.634-18.049 27.349-47.596-2.954-23.279c18.874-15.396 31.677-45.767 16.762-78.388-18.024-39.422-54.964-47.27-54.964-47.27l2.07 70.755-56.364-28.259c-5.169 72.541 40.787 95.467 69.029 93.252l1.031 8.098-18.917 32.912-40.512 15.688c-13.516-20.728-36.811-43.303-38.589-58.287 5.144-4.336 8.407-10.82 8.407-18.075.0-13.051-10.578-23.631-23.63-23.631s-23.64 10.58-23.64 23.631c0 6.475 2.611 12.34 6.818 16.607-7.007 10.501-6.414 17.723-33.978 17.723-27.555.0-26.97-7.222-33.977-17.723 4.216-4.267 6.826-10.132 6.826-16.607.0-13.051-10.588-23.631-23.648-23.631-13.052.0-23.622 10.58-23.622 23.631.0 7.256 3.263 13.739 8.406 18.075-1.777 14.984-25.073 37.558-38.588 58.287l-40.521-15.688-18.9-32.912 1.022-8.098c28.242 2.215 74.198-20.711 69.021-93.252l-56.364 28.259 2.078-70.755s-36.948 7.849-54.963 47.27c-14.924 32.62-2.113 62.992 16.752 78.388l-2.954 23.279 27.348 47.596 46.635 18.049c-1.606 4.491-2.998 9.213-4.174 14.099l-65.336-8.26L26.756 281.91.0 327.935l15.353 10.158 28.671-37.773 32.088-18.376 56.596 7.162c-.293 4.259-.404 8.518-.301 12.786l-40.71 13.567L52.216 362.84l-6.414 60.279 18.195 2.868 11.42-52.628 30.672-36.811 29.478-9.832c2.216 9.223 5.634 17.929 10.45 25.64l-27.624 19.174-11.867 51.546 15.903 52.791 17.774-4.808-8.569-49.176 9.247-36.064 20.574-14.28c34.467 33.874 81.737 33.643 94.539 33.643 12.812.0 60.073.231 94.549-33.643l20.574 14.28 9.239 36.064-8.56 49.176 17.774 4.808 15.903-52.791-11.876-51.546-27.632-19.174c4.826-7.711 8.244-16.418 10.458-25.64l29.479 9.832 30.68 36.811 11.412 52.628 18.195-2.868-6.414-60.279-39.482-47.381-40.71-13.567c.112-4.267-.009-8.526-.292-12.786l56.595-7.162 32.081 18.376 28.67 37.773L512 327.935 485.235 281.91z"/></g></svg>
</span></span><span class=dark:text-neutral-300>Pour trouver le nom des arguments (<code>uprobe_target</code> et <code>uprobe_fn_name</code>), vous pouvez regarder le fichier <a href=https://github.com/aya-rs/aya-template/blob/e50b81fd6747f5e4247c4d4a7cd8b0c21c51d8bb/test.sh#L46 target=_blank>test.sh</a> dans le repo <a href=https://github.com/aya-rs/aya-template/ target=_blank>aya-template</a>.</span></div><p>Vous aurez la sortie suivante :</p><pre tabindex=0><code>🔧   program_type: &#34;uprobe&#34; (value from CLI)
🔧   uprobe_target: &#34;/home/cloud_user/hello&#34; (value from CLI)
🔧   uprobe_fn_name: &#34;main.hello&#34; (value from CLI)
🔧   Destination: /home/cloud_user/test-uprobe ...
🔧   project-name: test-uprobe ...
🔧   Generating template ...
[ 1/23]   Done: .gitignore
[ 2/23]   Done: Cargo.toml
[ 3/23]   Done: LICENSE-APACHE
[ 4/23]   Done: LICENSE-GPL2
[ 5/23]   Done: LICENSE-MIT
[ 6/23]   Done: README.md
[ 7/23]   Ignored: pre-script.rhai
[ 8/23]   Done: rustfmt.toml
[ 9/23]   Done: test-uprobe/Cargo.toml
[10/23]   Done: test-uprobe/build.rs
[11/23]   Done: test-uprobe/src/main.rs
[12/23]   Done: test-uprobe/src
[13/23]   Done: test-uprobe
[14/23]   Done: test-uprobe-common/Cargo.toml
[15/23]   Done: test-uprobe-common/src/lib.rs
[16/23]   Done: test-uprobe-common/src
[17/23]   Done: test-uprobe-common
[18/23]   Done: test-uprobe-ebpf/Cargo.toml
[19/23]   Done: test-uprobe-ebpf/build.rs
[20/23]   Done: test-uprobe-ebpf/src/lib.rs
[21/23]   Done: test-uprobe-ebpf/src/main.rs
[22/23]   Done: test-uprobe-ebpf/src
[23/23]   Done: test-uprobe-ebpf
🔧   Initializing a fresh Git repository
✨   Done! New project created /home/cloud_user/test-uprobe
</code></pre><h3 class="relative group">Compilation et installation dans le noyau<div id=compilation-et-installation-dans-le-noyau class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#compilation-et-installation-dans-le-noyau aria-label=Ancre>#</a></span></h3><p>Maintenant qu&rsquo;on a généré le programme, il faut compiler le programme et l&rsquo;installer dans le noyau linux :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=k>cd</span> <span class=k>test</span>-uprobe/
</span></span><span class=line><span class=cl><span class=nv>RUST_LOG</span><span class=o>=</span>info <span class=nf>cargo</span> run
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md
alert-warning"><span class="ltr:pr-3 rtl:pl-3 flex items-center
alert-icon-warning"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 0c4.6.0 9.2 1 13.4 2.9L457.7 82.8c22 9.3 38.4 31 38.3 57.2-.5 99.2-41.3 280.7-213.7 363.2-16.7 8-36.1 8-52.8.0C57.3 420.7 16.5 239.2 16 140c-.1-26.2 16.3-47.9 38.3-57.2L242.7 2.9C246.8 1 251.4.0 256 0zm0 66.8v378C394 378 431.1 230.1 432 141.4L256 66.8z"/></svg></span>
</span><span class=dark:text-neutral-300>Pour simplifier, j&rsquo;ai fait la compilation et l&rsquo;installation du programme eBPF en root.</span></div><p>Cela va prendre un peu de temps la première fois :</p><pre tabindex=0><code>Updating crates.io index
     Locking 103 packages to latest compatible versions
      Adding which v6.0.3 (available: v8.0.0)
  Downloaded anstyle v1.0.11
  Downloaded cfg-if v1.0.1
  Downloaded anyhow v1.0.98
  Downloaded either v1.15.0
  Downloaded cargo_metadata v0.19.2
  Downloaded version_check v0.9.5
  Downloaded which v6.0.3
  Downloaded socket2 v0.6.0
  Downloaded mio v1.0.4
[...]
warning: test-uprobe@0.1.0:     Finished `release` profile [optimized] target(s) in 19.59s
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 50.16s
     Running `/root/build-cache/debug/test-uprobe`
Waiting for Ctrl-C...
</code></pre><h3 class="relative group">Testons maintenant<div id=testons-maintenant class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#testons-maintenant aria-label=Ancre>#</a></span></h3><p>Laisser le programme Aya tourné et sur un autre terminal, lancer le programme que vous voulez examiner. Pour mon cas :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>./hello
</span></span></code></pre></div><p>Sur le terminal où on a lancé la commande <code>cargo run</code>, Vous devriez voir la sortie suivante à chaque fois que vous lancez le programme :</p><pre tabindex=0><code>[INFO  test_uprobe] function main.hello called by /home/cloud_user/hello
</code></pre><p>Vous voyez que la difficulté est la même qu&rsquo;avec <em>bpftrace</em> mais que le temps de compilation est beaucoup plus long.</p><hr><h2 class="relative group">Créons un programme eBPF de type uRetProbe<div id=créons-un-programme-ebpf-de-type-uretprobe class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#cr%c3%a9ons-un-programme-ebpf-de-type-uretprobe aria-label=Ancre>#</a></span></h2><p>Nous avons vu un exemple de programme eBPF de type uProbe où on n&rsquo;avait pas à modifier le code généré. Nous allons maintenant complexifier légèrement avec un programme eBPF de type <strong>uRet</strong>Probe et nous allons récupérer la valeur de retour.</p><p><figure><img class="my-0 rounded-md" loading=lazy alt="Go uretprobe" src=https://blog.littlejo.link/assets/svg/uprobe/go-uretprobe.svg></figure></p><h3 class="relative group">Testons avec bpftrace<div id=testons-avec-bpftrace-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#testons-avec-bpftrace-1 aria-label=Ancre>#</a></span></h3><p>Le code bpftrace est alors légèrement modifié :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>sudo</span> <span class=nf>bpftrace</span> <span class=na>-e</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>&#39;uretprobe:/home/cloud_user/hello:main.hello { printf(&#34;retval=%d\n&#34;, retval); }&#39;</span>
</span></span></code></pre></div><ul><li><code>uprobe</code> est donc remplacé par <code>uretprobe</code></li><li>on a rajouté la variable de retour : <code>retval</code></li></ul><p>Lancer le programme <code>hello</code> dans un autre terminal et vous verrez dans le terminal <em>bpftrace</em> :</p><pre tabindex=0><code>retval=3
</code></pre><p>Regardons comment produire le programme équivalent en Aya.</p><h3 class="relative group">Génération du programme Aya<div id=génération-du-programme-aya-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#g%c3%a9n%c3%a9ration-du-programme-aya-1 aria-label=Ancre>#</a></span></h3><p>La génération du code se fait de manière similaire qu&rsquo;avec une uProbe :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nv>target</span><span class=o>=</span>/home/cloud_user/hello
</span></span><span class=line><span class=cl><span class=nv>fn_name</span><span class=o>=</span>main.hello
</span></span><span class=line><span class=cl><span class=nf>cargo</span> generate <span class=na>--name</span> test-uretprobe <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               <span class=na>-d</span> <span class=nv>program_type</span><span class=o>=</span>uretprobe <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               <span class=na>-d</span> <span class=nv>uprobe_target</span><span class=o>=</span><span class=nv>$target</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               <span class=na>-d</span> <span class=nv>uprobe_fn_name</span><span class=o>=</span><span class=nv>$fn_name</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               <span class=nf>https</span>://github.com/aya-rs/aya-template
</span></span></code></pre></div><h3 class="relative group">Compilation et installation<div id=compilation-et-installation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#compilation-et-installation aria-label=Ancre>#</a></span></h3><p>De la même manière on va compiler et installer le programme eBPF :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=k>cd</span> <span class=k>test</span>-uretprobe/
</span></span><span class=line><span class=cl><span class=nv>RUST_LOG</span><span class=o>=</span>info <span class=nf>cargo</span> run
</span></span></code></pre></div><p>À la sortie de chaque fonction <code>hello()</code>, le programme eBPF affiche bien :</p><pre tabindex=0><code>[INFO  test_uretprobe] function main.hello called by /home/cloud_user/hello
</code></pre><p>Jusqu&rsquo;à présent, nous avons fait un peu près la même chose que pour l&rsquo;uProbe. Regardons maintenant comment récupérer la valeur de retour 3.</p><h3 class="relative group">Modification du code<div id=modification-du-code class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#modification-du-code aria-label=Ancre>#</a></span></h3><p>Il faut modifier le fichier <code>test-uretprobe-ebpf/src/main.rs</code> : le code de l&rsquo;espace noyau. En particulier ce bout de code :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Rust data-lang=Rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>try_test_uretprobe</span><span class=p>(</span><span class=n>ctx</span>: <span class=nc>RetProbeContext</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=kt>u32</span><span class=p>,</span><span class=w> </span><span class=kt>u32</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>info!</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span><span class=w> </span><span class=s>&#34;function main.hello called by /home/cloud_user/hello&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Il faut voir comment utiliser la structure <code>RetProbeContext</code> pour afficher le code retour.</p><p>Regardons la <a href=https://docs.rs/aya-ebpf/latest/aya_ebpf/programs/retprobe/struct.RetProbeContext.html target=_blank>documentation</a> :</p><p><figure><img class="my-0 rounded-md" loading=lazy alt="Aya uRetProbe documentation" src=https://blog.littlejo.link/assets/screenshot/uprobe/uretprobe-doc.webp></figure></p><p>Il faut donc utiliser la méthode <code>ret()</code>. On va rajouter un truc comme ça :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Rust data-lang=Rust><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>retval</span>: <span class=kt>u32</span> <span class=o>=</span><span class=w> </span><span class=n>ctx</span><span class=p>.</span><span class=n>ret</span><span class=p>().</span><span class=n>ok_or</span><span class=p>(</span><span class=mi>1</span><span class=k>u32</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><div class="flex px-4 py-3 rounded-md
alert-info"><span class="ltr:pr-3 rtl:pl-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg fill="currentColor" width="685.64758" height="685.71362" viewBox="0 0 11.999 12.000156" role="img" focusable="false" aria-hidden="true" id="svg1"><path d="M11.915172 5.853138 11.411397 5.541524c-.004-.04905-.0087-.0981-.01443-.146573l.432797-.403944c.04386-.04097.06348-.101562.05194-.160423-.01154-.05886-.05309-.10791-.109064-.128685L11.219237 4.494734c-.01385-.0479-.02828-.09521-.04328-.143111L11.52104 3.872085C11.55624 3.823615 11.56317 3.760135 11.54066 3.70416 11.51815 3.64818 11.46737 3.60894 11.408513 3.599134l-.58341-.09521c-.0225-.04443-.04616-.08771-.0704-.130993l.245251-.538398c.02481-.05482.0202-.118298-.01385-.168503-.03405-.0502-.08944-.07906-.150036-.07675L10.244003 2.61005C10.213423 2.57196 10.182253 2.53388 10.150523 2.496369l.136187-.577061c.01385-.05886-.0035-.120029-.04617-.162732-.0427-.0427-.103872-.06001-.162155-.04616L9.5019002 1.846603c-.03751-.03174-.07559-.0629-.113681-.09348l.02078-.592066c.0023-.06001-.02712-.117143-.07675-.150036-.04963-.03289-.113681-.03866-.167925-.01385l-.538398.245251c-.04328-.02366-.08714-.04732-.130993-.0704l-.09522-.58341c-.0098-.05944-.04905-.109642-.105025-.132147-.05598-.02251-.118875-.01558-.167348.01962l-.47954.345074c-.04732-.015-.09464-.02943-.142534-.04328L7.2981012.224477c-.02078-.05655-.06983-.0981-.128685-.109642-.05886-.01154-.119452.0081-.160423.05194L6.6050495.600148C6.5565765.594948 6.5075255.589758 6.4584758.585718L6.1468624.081943C6.115124.031161 6.059149.0 5.9991346.0 5.9391206.0 5.8831452.03116 5.8519838.08194L5.5403705.585715c-.04905.004-.0981.0092-.1471508.01443L4.9892765.166771C4.9483055.122911 4.8877136.103291 4.8288533.114831 4.7699933.126371 4.7209427.167921 4.7001685.224473L4.4930033.777875c-.047896.01385-.095215.02828-.1425342.04328L3.8709307.476076c-.04905-.0352-.112527-.0427-.167925-.01962s-.095215.07329-.1044482.132147l-.095215.58341c-.043857.02251-.087713.04616-.130993.0704L2.8339507.997163c-.054821-.02481-.1182977-.01962-.1685021.01385-.050204.03347-.079057.09002-.076749.150036l.020774.592066c-.038086.03058-.076172.06174-.1136811.09348l-.5770618-.136184c-.058283-.01385-.1200289.004-.1621544.04616-.042126.04213-.060014.103871-.046165.162732l.1361865.577061c-.031738.03751-.0629.07502-.093484.113681L1.1610484 2.589275c-.060014-.0017-.1165665.02712-.150036.07675-.03347.04963-.038663.113682-.01385.168503l.2452512.538398c-.023659.04328-.047319.08656-.070402.130993L.5886021 3.599129C.5291651 3.608929.4795375 3.648179.456455 3.704155.433372 3.760135.440874 3.823029.476075 3.87208l.3450829.479538c-.015004.04732-.02943.09521-.04328.143111l-.5534007.20717c-.055975.02078-.097523.06982-.1090646.128685-.011541.05886.00808.119452.051935.160423l.4327964.403944C.594954 5.444001.589757 5.492471.585717 5.541524L.081943 5.853138C.031162 5.884876.0 5.940274.0 6.000866.0 6.061456.031161 6.116855.081943 6.148016l.5037751.311614c.00404.04905.00923.0981.014427.146573l-.4327964.403944c-.043857.04097-.063477.101563-.051935.160423.011541.05886.05309.107333.1090646.128685L.7778806 7.50642c.01385.0479.028276.09579.04328.143111L.4760762 8.129069c-.035201.04905-.042703.11195-.01962.167348.023082.0554.073287.09522.1321471.105026l.5834095.09521c.022505.04443.046165.08771.070402.130993L.9971636 9.165467c-.024814.05482-.01962.118298.01385.168503.033469.0502.090599.07906.150036.07675L1.753115 9.38995c.030584.03866.061746.07617.093484.113681l-.1361865.577061c-.01385.05886.00346.119452.046165.162155.042703.0427.1038711.06001.1621544.04616l.5770618-.13561c.037509.03174.075595.0629.1136811.09348l-.020774.592643c-.00231.06001.027122.117143.076749.150036.049627.03289.1136812.03866.1685021.01327l.5383986-.245251c.04328.02424.087136.04732.130993.0704l.095215.58341c.00981.05944.04905.109642.1050253.132147.055975.02251.1188747.01558.167925-.01904l.4795383-.34566c.047319.015.095215.02943.1431113.04328l.2071652.553402c.020774.05598.069824.09752.1286848.109065.05886.01154.1194518-.0081.1604232-.05194l.4039432-.432796c.048473.0058.098101.01039.1471508.01443l.3116134.503775c.031161.05078.087136.08194.1471507.08194.060014.0.1159895-.03116.1471508-.08194l.3116134-.503775c.04905-.004.0981-.0092.1465737-.01443l.4039436.432796c.04097.04386.101562.06348.160423.05194.05886-.01154.107333-.05309.128685-.109065l.207165-.553402c.0479-.01385.09579-.02828.143111-.04328l.479538.34566c.04847.0352.11195.04213.167348.01904.0554-.02308.09522-.07329.105026-.132147l.09521-.58341c.04386-.02308.08771-.04674.130993-.0704l.538398.245251c.05482.02481.118298.0202.167925-.01327.04963-.03347.07906-.09002.07675-.150036l-.02078-.592643c.03809-.03058.07617-.06174.113682-.09348l.5770608.13561c.05828.01385.120029-.0035.162155-.04616.04213-.0427.06001-.103871.04617-.162155l-.13561-.577061c.03174-.03751.0629-.07502.09348-.113681l.592066.02077c.06001.0023.117143-.02655.150036-.07675.03289-.0502.03866-.113682.01327-.168503L10.756422 8.627646c.02366-.04328.04732-.08714.0704-.130993l.58341-.09521c.05944-.0092.109065-.04905.132147-.105026.02308-.05598.01558-.118874-.01962-.167348L11.177676 7.649531c.015-.04732.02943-.09521.04328-.143111l.553402-.207165c.05598-.02135.09752-.06982.109065-.128685.01212-.05886-.0075-.119452-.05194-.160423L11.398687 6.606203c.0052-.04905.0098-.09752.01443-.146573l.503775-.311614c.05078-.03116.08194-.08714.08194-.14715s-.03116-.11599-.08194-.147728zm-3.3717718 4.178504c-.192162-.04155-.314499-.231402-.273527-.42414.04097-.192739.230824-.315653.422986-.273527.192738.04097.315076.230824.273527.423563-.04155.192739-.230825.315076-.422986.274104zM8.3720132 8.874056c-.175427-.03751-.347969.07386-.385478.249868l-.178889.835008c-.552248.250445-1.1645106.389517-1.8102428.389517-.6601587.0-1.2862707-.145996-1.8483289-.407405L3.9701853 9.106612C3.9326763 8.931185 3.7601348 8.819235 3.5847081 8.856744L2.8478002 9.014859C2.7110365 8.874056 2.5840829 8.72402 2.4669394 8.565905h3.5852849c.040394.0.067516-.0075.067516-.04443V7.253093c0-.03693-.027122-.04443-.067516-.04443H5.003703V6.404816h1.1339264c.1032941.0.5534023.02943.6970907.604761.045011.176581.1442651.752488.2117821.936571.06752.206588.34162.619187.63419.619187h1.786584c.0202.0.04213-.0023.06463-.0063-.124069.168502-.259678.327771-.406252.476653L8.3720132 8.873479zM3.4138978 10.01433C3.2217362 10.05588 3.0318829 9.93296 2.9909115 9.740226 2.9499405 9.547487 3.0722775 9.357634 3.2644388 9.316086 3.4566003 9.275116 3.6464537 9.397456 3.6874251 9.59019 3.7283961 9.782929 3.6060591 9.972782 3.4138978 10.01433zM2.0537631 4.499351C2.1333981 4.679394 2.0526131 4.890599 1.8725657 4.970233 1.6925224 5.049863 1.4824719 4.969033 1.4022604 4.788459 1.3226254 4.608415 1.4034104 4.397788 1.5834578 4.317576 1.763501 4.237366 1.9735515 4.318776 2.0537631 4.499351zm-.4177927.990815.7674922-.341044C2.5673481 5.076412 2.641212 4.884251 2.5685022 4.719788L2.4103873 4.36201h.6214956V7.164222H1.7773505c-.1090647-.382592-.1673479-.785958-.1673479-1.203174.0-.159269.00866-.316807.024814-.471459zM5.0042801 5.21837V4.392594h1.4807405c.076749.0.5401296.08829.5401296.435105.0.287954-.3554698.390671-.6480401.390671zm5.3799469.743255c0 .109642-.004.21813-.01212.325463H9.9219982c-.04501.0-.06348.02943-.06348.07386v.206588c0 .486463-.274682.592643-.514739.619188-.229094.02597-.483001-.09579-.514162-.236019-.135033-.759413-.360087-.921567-.715557-1.202019.441452-.279875.900216-.693052.900216-1.246454.0-.597259-.409714-.973503-.688434-1.157586C7.9340172 3.0867 7.5006432 3.034764 7.3840772 3.034764H2.7289194c.6313116-.704588 1.4865172-1.20317 2.4542498-1.384944l.5487858.575907c.1240683.129839.3295023.134456.4593412.01039l.6139937-.587448c1.2862703.23948 2.3757633 1.040442 3.0030293 2.139168L9.3882182 4.7371c-.07271.164463.0017.356624.165617.429334l.8090408.35951c.01385.143688.02135.289108.02135.435681zM5.7325321 1.160471C5.8744893 1.024285 6.1001204 1.029478 6.236307 1.172011 6.3724936 1.314545 6.366723 1.540753 6.224189 1.676363 6.0822318 1.812549 5.8566006 1.807356 5.7204141 1.664823 5.5842275 1.522289 5.5899981 1.296658 5.7325321 1.160471zM9.9035352 4.516663C9.9831652 4.336619 10.193797 4.255254 10.37384 4.334888 10.553883 4.414518 10.634672 4.625727 10.555037 4.805771 10.475407 4.985814 10.264775 5.06718 10.084732 4.987545 9.9046892 4.907915 9.8239002 4.696706 9.9035352 4.516663z" id="path1"/></svg>
</span></span><span class=dark:text-neutral-300>Si la fonction n&rsquo;a pas de retour on affiche <code>1u32</code> (entier non signé de 32 bits) car la signature de la fonction est <code>Result&lt;u32, u32></code>.</span></div><p>Il faut également modifier la macro Aya <code>info!</code> pour afficher cette valeur.</p><p>Ce qui donne au final :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Rust data-lang=Rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>try_test_uretprobe</span><span class=p>(</span><span class=n>ctx</span>: <span class=nc>RetProbeContext</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=kt>u32</span><span class=p>,</span><span class=w> </span><span class=kt>u32</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>retval</span>: <span class=kt>u32</span> <span class=o>=</span><span class=w> </span><span class=n>ctx</span><span class=p>.</span><span class=n>ret</span><span class=p>().</span><span class=n>ok_or</span><span class=p>(</span><span class=mi>1</span><span class=k>u32</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>info!</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span><span class=w> </span><span class=s>&#34;retval={}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>retval</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">Testons maintenant<div id=testons-maintenant-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#testons-maintenant-1 aria-label=Ancre>#</a></span></h3><p>Appliquons les modifications :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nv>RUST_LOG</span><span class=o>=</span>info <span class=nf>cargo</span> run
</span></span></code></pre></div><p>Lançons la commande <code>hello</code> dans un autre terminal :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl>./hello
</span></span></code></pre></div><p>Et du côté du programme Aya, on a l&rsquo;affichage suivant :</p><pre tabindex=0><code>[INFO  test_uretprobe] retval=3
</code></pre><p>Ce qui est cohérent avec ce qu&rsquo;on avait trouvé avec <em>bpftrace</em>.</p><hr><p>Cet épisode est maintenant terminé ! Nous avons vu les bases pour faire réagir un programme eBPF de type uProbe et uRetProbe lors du lancement d&rsquo;un programme Go.</p><p>Cependant, nous n&rsquo;avons pas encore exploré comment récupérer les arguments d&rsquo;une fonction.</p><p>Ça tombe bien ! Dans le prochain épisode, nous allons sonder une bibliothèque bien connue en récupérant les arguments de fonction et en les traitant !</p></div><details class="mt-2 mb-5 overflow-hidden rounded-lg ltr:ml-0 ltr:pl-5 rtl:mr-0 rtl:pr-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">Apprenons uProbe avec eBPF et Aya -
Cet article fait partie d'une série.</summary><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/ebpf-another-type/uprobe/intro/>Partie 1:
L’observabilité pour tous les développeurs avec les uProbes</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">Partie 2:
Cet article</div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/ebpf-another-type/uprobe/example-2-tr/>Partie 3:
Sondons une bibliothèque avec une uProbe</a></div></details><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/&amp;title=Observons%20une%20fonction%20simple%20de%20ton%20programme%20avec%20des%20uProbes" title="Poster sur LinkedIn" aria-label="Poster sur LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://bsky.app/intent/compose?text=Observons%20une%20fonction%20simple%20de%20ton%20programme%20avec%20des%20uProbes+https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/" title aria-label><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://s2f.kytta.dev/?text=Observons%20une%20fonction%20simple%20de%20ton%20programme%20avec%20des%20uProbes%20https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/" title aria-label><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://blog.littlejo.link/ebpf-another-type/uprobe/example-1/&amp;subject=Observons%20une%20fonction%20simple%20de%20ton%20programme%20avec%20des%20uProbes" title="Envoyer par email" aria-label="Envoyer par email"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></section></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_ebpf-another-type/uprobe/example-1/index.md data-oid-likes=likes_ebpf-another-type/uprobe/example-1/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/ebpf-another-type/uprobe/example-2-tr/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Sondons une bibliothèque avec une uProbe</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-09-15T10:20:56+02:00>15 septembre 2025</time>
</span></span></a></span><span></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Faire défiler jusqu'au bas de la page" title="Faire défiler jusqu'au bas de la page">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Joseph Ligier</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom):not(a > img)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://blog.littlejo.link/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Rechercher tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Fermer (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>