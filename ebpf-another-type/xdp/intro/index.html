<!doctype html><html lang=fr dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="fr"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>XDP, le firewall ultra rapide de Linux &#183; Le blog de Little Jo</title><meta name=title content="XDP, le firewall ultra rapide de Linux &#183; Le blog de Little Jo"><meta name=description content="D√©couverte de XDP avec Aya"><meta name=keywords content="Rust,eBPF,aya,xdp,"><link rel=canonical href=https://blog.littlejo.link/ebpf-another-type/xdp/intro/><meta name=author content="Joseph Ligier"><link href=https://bsky.app/profile/littlejo.bsky.social rel=me><link href=https://www.linkedin.com/in/joseph-ligier-4b86632 rel=me><link href=https://dev.to/littlejo rel=me><link href=https://medium.com/@littel.jo rel=me><link href=https://github.com/littlejo rel=me><link href=https://ko-fi.com/littlejo rel=me><meta property="og:url" content="https://blog.littlejo.link/ebpf-another-type/xdp/intro/"><meta property="og:site_name" content="Le blog de Little Jo"><meta property="og:title" content="XDP, le firewall ultra rapide de Linux"><meta property="og:description" content="D√©couverte de XDP avec Aya"><meta property="og:locale" content="fr"><meta property="og:type" content="article"><meta property="article:section" content="ebpf-another-type"><meta property="article:published_time" content="2025-10-16T12:47:22+02:00"><meta property="article:modified_time" content="2025-10-16T12:47:22+02:00"><meta property="article:tag" content="Rust"><meta property="article:tag" content="EBPF"><meta property="article:tag" content="Aya"><meta property="article:tag" content="Xdp"><meta property="og:image" content="https://blog.littlejo.link/ebpf-another-type/xdp/intro/featured.webp"><meta property="og:see_also" content="https://blog.littlejo.link/ebpf-another-type/xdp/example-2-tr/"><meta property="og:see_also" content="https://blog.littlejo.link/ebpf-another-type/xdp/example-1/"><meta property="og:see_also" content="https://blog.littlejo.link/ebpf-another-type/uprobe/intro/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.littlejo.link/ebpf-another-type/xdp/intro/featured.webp"><meta name=twitter:title content="XDP, le firewall ultra rapide de Linux"><meta name=twitter:description content="D√©couverte de XDP avec Aya"><link type=text/css rel=stylesheet href=/css/main.bundle.min.b40b1ed6cd8b0f0b23d4e4d8d2cc52d50cc15b8e9d2c4b8e19a08fb960c4035326895dbbda305c98701405a07ac803e772fce0015b40d6e84c118999062b9ac3.css integrity="sha512-tAse1s2LDwsj1OTY0sxS1QzBW46dLEuOGaCPuWDEA1MmiV272jBcmHAUBaB6yAPncvzgAVtA1uhMEYmZBiuaww=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script type=text/javascript src=/js/zen-mode.min.9814dee9614d32aeb56239d118edfe20acd6231424f9b19c2dd48835038414130a5e946c0d1c9087d60e60e31840c9babfd217e3d4b95643dc8d651a71ccdf4a.js integrity="sha512-mBTe6WFNMq61YjnRGO3+IKzWIxQk+bGcLdSINQOEFBMKXpRsDRyQh9YOYOMYQMm6v9IX49S5VkPcjWUacczfSg=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP+pSqMXxm6JPOUeAg==" data-copy=Copier data-copied=Copi√©></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Ebpf-Another-Types","name":"XDP, le firewall ultra rapide de Linux","headline":"XDP, le firewall ultra rapide de Linux","description":"D√©couverte de XDP avec Aya","abstract":"D√©couverte de XDP avec Aya","inLanguage":"fr","url":"https:\/\/blog.littlejo.link\/ebpf-another-type\/xdp\/intro\/","author":{"@type":"Person","name":"Joseph Ligier"},"copyrightYear":"2025","dateCreated":"2025-10-16T12:47:22\u002b02:00","datePublished":"2025-10-16T12:47:22\u002b02:00","dateModified":"2025-10-16T12:47:22\u002b02:00","keywords":["Rust","eBPF","aya","xdp"],"mainEntityOfPage":"true","wordCount":"2529"}]</script><script data-goatcounter=https://littlejo-prd.goatcounter.com/count async src=/js/count.js></script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Aller au contenu</a></div><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium">Le blog de Little Jo</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/categories/introduction/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Introduction><p class="text-base font-medium">Blog</p></a><div><div class="cursor-pointer flex items-center nested-menu"><span class=me-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium hover:text-primary-600 dark:hover:text-primary-400" title="XDP, le firewall ultra rapide de Linux">FR</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/ebpf-another-type/xdp/intro/ class="flex items-center"><p class="text-sm font-sm hover:text-primary-600 dark:hover:text-primary-400" title="XDP, le firewall ultra rapide de Linux">FR</p></a><a href=/en/ebpf-another-type/xdp/intro/ class="flex items-center"><p class="text-sm font-sm hover:text-primary-600 dark:hover:text-primary-400" title="XDP: The Ultra-Fast Firewall Inside Linux">EN</p></a></div></div></div></div><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Rechercher (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span><div><div class="cursor-pointer flex items-center nested-menu"><span class=me-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium hover:text-primary-600 dark:hover:text-primary-400" title="XDP, le firewall ultra rapide de Linux">FR</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/ebpf-another-type/xdp/intro/ class="flex items-center"><p class="text-sm font-sm hover:text-primary-600 dark:hover:text-primary-400" title="XDP, le firewall ultra rapide de Linux">FR</p></a><a href=/en/ebpf-another-type/xdp/intro/ class="flex items-center"><p class="text-sm font-sm hover:text-primary-600 dark:hover:text-primary-400" title="XDP: The Ultra-Fast Firewall Inside Linux">EN</p></a></div></div></div></div><button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Rechercher (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/categories/introduction/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Introduction><p class="text-bg font-bg">Blog</p></a></li></ul></div></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/ebpf-another-type/xdp/intro/featured_hu_7e4620a81e6b46a6.webp alt="XDP, le firewall ultra rapide de Linux" loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=background-blur data-image-id=background-image data-image-url=/ebpf-another-type/xdp/intro/featured_hu_7e4620a81e6b46a6.webp></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Le blog de Little Jo</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/ebpf-another-type/>Ebpf-Another-Types</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/ebpf-another-type/xdp/intro/>XDP, le firewall ultra rapide de Linux</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">XDP, le firewall ultra rapide de Linux</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-10-16T12:47:22+02:00>16 octobre 2025</time><span class="px-2 text-primary-500">&#183;</span><span>2529 mots</span><span class="px-2 text-primary-500">&#183;</span><span title="Temps de lecture">12 mins</span><span class="px-2 text-primary-500">&#183;</span><span class=mb-[2px]>
<span id=zen-mode-button class="text-lg hover:text-primary-500" title="Activer le mode zen" data-title-i18n-disable="Activer le mode zen" data-title-i18n-enable="D√©sactiver le mode zen"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt="Joseph Ligier" src=/img/littlejo_hu_4250d52962eec5b0.jpg data-zoom-src=/img/littlejo.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Auteur</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Joseph Ligier</div><div class="text-sm text-neutral-700 dark:text-neutral-400">CNCF ambassador | Kubestronaut üêù</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://bsky.app/profile/littlejo.bsky.social target=_blank aria-label=Bluesky title=Bluesky rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/joseph-ligier-4b86632 target=_blank aria-label=Linkedin title=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://dev.to/littlejo target=_blank aria-label=Dev title=Dev rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88.0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59.0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21.0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44.0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44.0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://medium.com/@littel.jo target=_blank aria-label=Medium title=Medium rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M180.5 74.262C80.813 74.262.0 155.633.0 256S80.819 437.738 180.5 437.738 361 356.373 361 256 280.191 74.262 180.5 74.262zm288.25 10.646c-49.845.0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559C559 161.5 518.6 84.908 468.752 84.908zm139.506 17.821c-17.526.0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/littlejo target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://ko-fi.com/littlejo target=_blank aria-label=Ko-Fi title=Ko-Fi rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg width="211.67mm" height="211.67mm" viewBox="0 0 211.67 211.67"><defs><clipPath id="clipPath25"><path d="m0 6e2h1654.8V0H0z" fill="currentColor"/></clipPath></defs><g transform="translate(-3.0786 -29.59)"><g transform="matrix(.35278 0 0 -.35278 3.0785 241.26)"><g clip-path="url(#clipPath25)"><g transform="translate(600 300)"><path d="m-3e2 3e2c-165.69.0-3e2-134.31-3e2-3e2s134.31-3e2 3e2-3e2C-134.32-3e2.0-165.69.0.0s-134.32 3e2-3e2 3e2zm-188.93-166.99h329.58c23.223.0 46.032-6.8325 65.073-20.125 18.412-12.856 36.378-33.646 42.697-67.02 14.674-77.514-43.568-135.76-126.12-131.18.438-21.268-3.8105-59.422-44.878-69.696-3.282-.821-6.6604-1.186-10.044-1.207-72.13-.448-222.53-.88916-222.53-.88916s-46.066-.01555-49.176 45.962c-1.023 77.88-.48339 223.69-.48339 223.69s-.02651 2.9267-.02051 3.6577c.043 5.607 4.4359 16.8 15.901 16.8zm312.71-55.573v-107.8s14.302-1.6507 31.907.54932c20.356 6.6 39.06 20.901 39.06 57.199.0 14.85-5.2614 25.601-11.837 33.239-9.341 10.848-23.152 16.809-37.469 16.809h-21.661z" fill="currentColor"/></g><g transform="translate(256.61 203.37)"><path d="m0 0c3.585-1.806 5.876.437 5.876.437s52.457 47.878 76.089 75.452c21.018 24.667 22.389 66.234-13.708 81.766-36.096 15.532-65.795-18.272-65.795-18.272-25.755 28.326-64.734 26.891-82.763 7.721-18.027-19.169-11.732-52.072 1.717-70.383 12.626-17.19 68.119-66.65 76.529-75.015.0.0.614-.641 2.055-1.706" fill="currentColor"/></g></g></g></g></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Sommaire</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#quest-ce-quxdp->Qu‚Äôest-ce qu‚ÄôXDP ?</a></li><li><a href=#origin-story>Origin story</a><ul><li><a href=#les-anc√™tres-de-xdp>Les anc√™tres de XDP</a></li><li><a href=#netfilter--limmortel>Netfilter : l&rsquo;immortel</a></li><li><a href=#xdp--le-successeur->XDP : le successeur ?</a></li></ul></li><li><a href=#quels-projets-utilisent-xdp->Quels projets utilisent XDP ?</a><ul><li><a href=#katran--le-loadbalancer-de-facebook>Katran : le loadbalancer de Facebook</a></li><li><a href=#cilium--les-services-externes-de-kubernetes>Cilium : les services externes de Kubernetes</a></li><li><a href=#cloudflare--pour-emp√™cher-le-ddos>Cloudflare : pour emp√™cher le DDoS</a></li><li><a href=#et-bien-dautres>Et bien d&rsquo;autres</a></li></ul></li><li><a href=#comment-d√©buter-son-programme-xdp->Comment d√©buter son programme XDP ?</a><ul><li><a href=#cr√©ation-dun-environnement-pour-xdp>Cr√©ation d&rsquo;un environnement pour XDP</a></li><li><a href=#mon-premier-programme-xdp>Mon premier programme xdp</a></li><li><a href=#anatomie-dun-paquet-r√©seau>Anatomie d&rsquo;un paquet r√©seau</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Sommaire</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#quest-ce-quxdp->Qu‚Äôest-ce qu‚ÄôXDP ?</a></li><li><a href=#origin-story>Origin story</a><ul><li><a href=#les-anc√™tres-de-xdp>Les anc√™tres de XDP</a></li><li><a href=#netfilter--limmortel>Netfilter : l&rsquo;immortel</a></li><li><a href=#xdp--le-successeur->XDP : le successeur ?</a></li></ul></li><li><a href=#quels-projets-utilisent-xdp->Quels projets utilisent XDP ?</a><ul><li><a href=#katran--le-loadbalancer-de-facebook>Katran : le loadbalancer de Facebook</a></li><li><a href=#cilium--les-services-externes-de-kubernetes>Cilium : les services externes de Kubernetes</a></li><li><a href=#cloudflare--pour-emp√™cher-le-ddos>Cloudflare : pour emp√™cher le DDoS</a></li><li><a href=#et-bien-dautres>Et bien d&rsquo;autres</a></li></ul></li><li><a href=#comment-d√©buter-son-programme-xdp->Comment d√©buter son programme XDP ?</a><ul><li><a href=#cr√©ation-dun-environnement-pour-xdp>Cr√©ation d&rsquo;un environnement pour XDP</a></li><li><a href=#mon-premier-programme-xdp>Mon premier programme xdp</a></li><li><a href=#anatomie-dun-paquet-r√©seau>Anatomie d&rsquo;un paquet r√©seau</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!1,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><details class="mt-2 mb-5 overflow-hidden rounded-lg ms-0 ps-5" open><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 -ms-5 ps-5 dark:bg-primary-800 dark:text-neutral-100">Apprenons XDP avec Aya -
Cet article fait partie d'une s√©rie.</summary><div class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">Partie 1:
Cet article</div><div class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><a href=/ebpf-another-type/xdp/example-1/>Partie 2:
Impl√©mentons un petit firewall avec XDP</a></div><div class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><a href=/ebpf-another-type/xdp/example-2-tr/>Partie 3:
Att√©nuons les attaques DDoS avec XDP</a></div></details><div class="article-content max-w-prose mb-20"><p>Je d√©bute la programmation en eBPF avec Aya. L‚Äôid√©e de cette s√©rie d‚Äôarticles est d&rsquo;apprendre un nouveau type de programme eBPF et de l&rsquo;exp√©rimenter avec le framework Rust Aya.</p><p>Aujourd&rsquo;hui, nous allons nous plonger dans XDP : des programmes eBPF capables de filtrer ou rediriger des paquets r√©seau plus vite que son ombre.</p><p>Vous allez voir que cela peut √™tre tr√®s int√©ressant pour cr√©er un pare-feu efficace, capable de contrer les attaques en d√©ni de service mais √©galement pour load-balancer des millions de paquets r√©seaux.</p><div class="flex px-4 py-3 rounded-md
alert-tip"><span class="pe-3 flex items-center
alert-icon-tip"><span class="relative block icon"><svg width="35.895355" height="36.001198" viewBox="0 0 35.895355 36.001198" fill="none" id="svg13"><path fill-rule="evenodd" clip-rule="evenodd" d="m23.6364.10692772c.484.244422.6756.829517.4279 1.30684198-.489.9425-.7536 2.29434-.8548 3.68384-.0998 1.37144-.0333 2.66933.0689 3.4332.0712.53167-.308 1.01948-.847 1.08955s-1.0337-.30413-1.1048-.83581c-.1203-.89834-.1899-2.32813-.0808-3.82659.1078-1.4804.3972-3.14069 1.0658-4.42931998.2477-.4773282.8408-.666135 1.3248-.421712z" fill="#1a1a1a" id="path1"/><path d="m17.9279 15.4786c.591-2.7701-5.4162-3.2222-8.49374-3.1019-12.13253.2574-7.06117 7.5956-.344 8.4137 2.76434.3367 8.09894-1.8492 8.83774-5.3118z" fill="currentColor" id="path2"/><path d="m3.00152 13.9149c.34054-.2771.78266-.5279 1.33721-.743l.17291.5359.88014 1.0998 1.28927 1.153.9905-.145 4.95105-.5064 5.2045.5492c-.1637.515-.4287.9991-.7694 1.4477C15.5173 17.0017 11.9211 16.9114 9.96784 16.9078 9.44518 17.5136 9.25598 19.5736 9.2151 20.8038 9.17288 20.7999 9.1312 20.7954 9.09009 20.7904 8.54185 20.7236 8.00457 20.6134 7.48672 20.4672 7.43882 19.5053 7.77515 18.1299 8.01989 17.3664 6.48879 17.4486 4.86925 18.1947 3.97602 18.7145 3.56434 18.3884 3.20739 18.0402 2.91797 17.6812l1.98456-1.0757C4.59621 16.4519 3.62819 14.9452 3.00152 13.9149z" fill="currentColor" id="path3"/><path d="M16.8986 18.8203l1.7838 1.1899-8.0602 11.7636-1.9367-1.2919-1.48753-2.1642-.74485-3.5732 1.33387-3.1389 3.20141.9634z" fill="currentColor" id="path4"/><path fill-rule="evenodd" clip-rule="evenodd" d="M15.2758 11.0042c2.3911-5.0861403 8.2076-3.8391103 10.9546-2.0068003L18.6815 20.0147 17.8151 19.4368c-1.1 1.2586-3.3469 2.2113-4.3328 2.5303.1001 1.4145 1.3034 2.5052 1.8925 2.8737l-2.4801 3.6196c-2.89488-1.931-3.74047-4.6925-3.80141-5.8318l-1.0745-.0575c-1.89715 4.2428 1.07775 7.5309 2.91251 8.7548L7.72792 36.0012 8.28497 31.6116c-3.61109-3.0533-2.96504-7.6667-2.19063-9.5917C3.60654 21.5324-.71116398 17.9714.09996132 14.9451 1.51225 9.6757097 10.7796 9.7630597 15.2758 11.0042zm2.6538 4.4605c.5621-2.7545-5.4263-3.2044-8.49737-3.0844-1.95229.0414-3.45912.2662-4.5853.6176.50118 1.5357 1.66332 2.2994 2.22769 2.4976 3.56078-.7988 8.18428-.4303 10.85498-.0308zM17.705 16.192c-1.8625-.2387-4.6377-.3002-6.0775-.2966-1.95525 1.3169-2.20603 3.5377-2.03968 4.9319 2.64838.0449 6.94048-1.776 8.11718-4.6353zm-9.01016 4.5464c-.35729-2.0196.79278-3.9252 1.49856-4.7008-3.62095.1363-5.90362 1.15-7.01878 1.9457 1.19325 1.2879 3.24214 2.3888 5.52022 2.7551zM2.5405 17.15c.89512-.5396 2.4988-1.0361 3.3714-1.2581-1.26155-.9307-1.8124-1.9023-2.00718-2.5311-1.97331.9358-2.197 2.4008-1.36422 3.7892z" fill="#1a1a1a" id="path5"/><path fill-rule="evenodd" clip-rule="evenodd" d="m35.5569 8.0548297c-.4102-.35197-1.0318-.30931-1.3885.09529-.7042.79888-1.8771 1.54484-3.1462 2.1552803-1.2527.6024-2.4981 1.0253-3.2547 1.2163-.5265.1329-.844.6619-.7091 1.1814.1349.5195.6711.8329 1.1977.6999.8897-.2246 2.2604-.6937 3.6291-1.352 1.3521-.6503 2.8058-1.534 3.7687-2.6262703.3566-.4046.3132-1.01792-.097-1.3699z" fill="#1a1a1a" id="path6"/><path d="m23.2275 19.0151c2.385-1.5734 5.0488 3.7584 6.0825 6.621 4.2791 11.2045-4.5124 9.2957-7.785 3.4503-1.3468-2.4055-1.2788-8.1045 1.7025-10.0713z" fill="currentColor" id="path7"/><path d="m30.2594 32.1c.1337-.4151.2048-.9133.2005-1.5012L29.8914 30.6402 28.529 30.2441 26.9642 29.4933 26.7315 28.5324l-1.3687-4.7219L22.9067 19.25c-.4233.3418-.7798.7648-1.0748 1.2439.8604 1.297 2.2853 4.556 3.0167 6.343-.3751.7043-2.242 1.6452-3.3838 2.1411.0194.0372.0392.0737.0592.1095.2671.477.571.9279.9015 1.3475.9225-.3145 2.0908-1.135 2.7176-1.6436.4933 1.4325.3951 3.1933.2391 4.2049.4601.2554.9206.4525 1.3661.5837l.2722-2.2179c.2586.2232 2.0364.548 3.2389.7379z" fill="currentColor" id="path8"/><path d="m20.4651 21.1977-1.7838-1.1899-8.0602 11.7636 1.9367 1.2919 2.5898.5554 3.6382-.6495 2.4552-2.391-2.0992-2.5722z" fill="currentColor" id="path9"/><path fill-rule="evenodd" clip-rule="evenodd" d="M28.4238 19.774C32.3164 15.6893 28.976 10.8284 26.229 8.9960897L18.6802 20.0134l.8664.578c-.7738 1.4761-.8325 3.8884-.7651 4.9099-1.3678.4355-2.8419-.2597-3.4081-.6618l-2.48 3.6196c2.8948 1.931 5.8072 1.6761 6.9015 1.3073l.4544.9624c-3.2834 3.3181-7.4845 1.8196-9.3193.5958l-3.20344 4.6753 3.92084-2.1458c4.2173 2.1685 8.3155-.1422 9.8375-1.5687 1.3855 2.0962 6.3437 4.7225 8.8878 2.8521 4.4296-3.2567.8939-11.7094-1.9489-15.3635zm-5.1841-.7677c2.3812-1.5411 5.036 3.7742 6.0675 6.6308.6886 1.8029 1.0387 3.2663 1.1278 4.4284-1.6311.1134-2.7824-.666-3.1791-1.1089-.5757-3.5579-2.6452-7.6538-4.0162-9.9503zm-.6003.4767c.9185 1.6163 2.0106 4.1343 2.5437 5.4541-.51 2.2809-2.5052 3.3381-3.8784 3.7053-1.0291-2.4081-.916-7.0166 1.3347-9.1594zm-.9184 9.9439c2.0327-.4255 3.3963-2.1886 3.8628-3.1238 1.2211 3.3661 1.1184 5.8339.7856 7.1514-1.656-.6126-3.4549-2.0783-4.6484-4.0276zm5.6684 4.2977c.174-1.0207.0433-2.674-.073-3.5557 1.3454.8082 2.4645.9505 3.1284.8946-.1447 2.1554-1.4393 2.9062-3.0554 2.6611z" fill="#1a1a1a" id="path10"/></svg>
</span></span><span class=dark:text-neutral-300>Si tu ne connais pas eBPF, je te conseille de lire les deux premi√®res parties de ma s√©rie <a href=https://medium.com/@littel.jo/sinitier-%C3%A0-ebpf-avec-aya-c9d570560261 target=_blank>S‚Äôinitier √† eBPF avec Aya</a>. Cela couvre les bases et t&rsquo;aidera pour la suite de l&rsquo;article.</span></div><hr><h2 class="relative group">Qu‚Äôest-ce qu‚ÄôXDP ?<div id=quest-ce-quxdp- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#quest-ce-quxdp- aria-label=Ancre>#</a></span></h2><p>Comme vous devez vous en do√ªter, XDP est un type de programme eBPF orient√© r√©seau. XDP est l&rsquo;acronyme de e<strong>X</strong>press <strong>D</strong>ata <strong>P</strong>ath qu&rsquo;on pourrait traduire par <em>voie rapide pour les donn√©es</em>.</p><p>Pour bien comprendre la signification de cet acronyme, il faut avoir conscience de ce que parcourt un paquet r√©seau depuis la carte r√©seau jusqu&rsquo;√† une application comme un serveur Web. Traditionnellement il fait le parcours suivant sous Linux :<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Documentation ebpf" src=https://blog.littlejo.link/assets/svg/xdp/stack.svg></figure></p><p>XDP s&rsquo;ex√©cute directement au niveau du <em>driver</em>, permettant ainsi de r√©agir plus rapidement qu&rsquo;un firewall applicatif. Cette rapidit√© est notamment cruciale contre les attaques par d√©ni de service distribu√© (DDoS : <em>Distributed Denial of Service attack</em>).</p><div class="flex px-4 py-3 rounded-md
alert-info"><span class="pe-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 0c4.6.0 9.2 1 13.4 2.9L457.7 82.8c22 9.3 38.4 31 38.3 57.2-.5 99.2-41.3 280.7-213.7 363.2-16.7 8-36.1 8-52.8.0C57.3 420.7 16.5 239.2 16 140c-.1-26.2 16.3-47.9 38.3-57.2L242.7 2.9C246.8 1 251.4.0 256 0zm0 66.8v378C394 378 431.1 230.1 432 141.4L256 66.8z"/></svg></span>
</span><span class=dark:text-neutral-300><p>Si on veut √™tre pr√©cis, XDP peut intervenir √† 3 endroits diff√©rents selon la prise en charge de la carte r√©seau :</p><ul><li>Au niveau du firmware de la carte r√©seau (mode <em>offloaded</em>) mais seulement quelques mod√®les de carte r√©seaux prennent en charge cela</li><li>Au niveau du driver r√©seau (mode <em>native</em>), le cas le plus courant pour des serveurs standards</li><li>Au niveau de la pile r√©seau du noyau (mode <em>generic</em>), permettant ainsi de tester sur n&rsquo;importe quel ordinateur (comme ton portable)</li></ul><p>N&rsquo;h√©sitez pas √† consulter <a href=https://docs.ebpf.io/linux/program-type/BPF_PROG_TYPE_XDP/#driver-support target=_blank>cette page</a> pour plus de pr√©cision.</p></span></div><p>Par contre, XDP intervenant sur une couche r√©seau tr√®s basse, les donn√©es en sortie r√©cup√©r√©es sont brutes et non transform√©es par la couche r√©seau de Linux ce qui le rend plus complexe √† g√©rer pour certaines t√¢ches (comme le suivi des connexions et des retransmissions TCP).</p><p>Pour en savoir plus, n&rsquo;h√©sitez pas √† consulter la documentation officielle :</p><p><a href=https://docs.ebpf.io/linux/program-type/BPF_PROG_TYPE_XDP/ target=_blank><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Documentation ebpf" src=https://blog.littlejo.link/assets/screenshot/xdp/xdp.webp></figure></a></p><p>Nous allons maintenant parler du contexte de la cr√©ation de cette technologie.</p><hr><h2 class="relative group">Origin story<div id=origin-story class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#origin-story aria-label=Ancre>#</a></span></h2><h3 class="relative group">Les anc√™tres de XDP<div id=les-anc√™tres-de-xdp class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#les-anc%c3%aatres-de-xdp aria-label=Ancre>#</a></span></h3><p>On n&rsquo;a pas attendu XDP pour filtrer ou rediriger les paquets dans le noyau Linux.</p><p>Le premier firewall a √©t√© impl√©ment√© dans Linux 1.1 en 1994, il se nommait <a href=https://en.wikipedia.org/wiki/Ipfirewall target=_blank>ipfw</a> et pour le configurer il y avait la ligne de commande <code>ipfwadm</code>. Il est inspir√© du firewall cr√©√© pour FreeBSD.
Il a √©t√© remplac√© par <a href=https://en.wikipedia.org/wiki/Ipchains target=_blank>ipchains</a> dans Linux 2.2 en 1999 qui √©tait plus complet et adapt√© √† la nouvelle couche r√©seau du noyau.</p><h3 class="relative group">Netfilter : l&rsquo;immortel<div id=netfilter--limmortel class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#netfilter--limmortel aria-label=Ancre>#</a></span></h3><p>Pour la version 2.4 (2001) du noyau Linux, un tout nouveau pare-feu a √©t√© cr√©√© : Netfilter et sa ligne de commande <code>iptables</code> que tout ing√©nieur Linux r√©seau conna√Æt tr√®s bien encore aujourd&rsquo;hui. Netfilter traite les paquets r√©seaux √† divers endroits de la pile r√©seau de Linux donc bien apr√®s le driver.</p><p>Depuis cette version, Netfilter a √©volu√© pour g√©rer les nouveaut√©s comme IPv6, les cgroups.</p><div class="flex px-4 py-3 rounded-md
alert-info"><span class="pe-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg height="800" width="800" id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 26 26"><g><path style="fill:currentColor" d="M25.484 7.114l-4.278-3.917C21.034 3.069 20.825 3 20.61 3H5.38c-.215.0-.424.069-.597.197l-4.38 4C.403 7.197.0 7.453.0 8v2c0 .551.449 1 1 1h24c.551.0 1-.449 1-1V8C26 7.469 25.484 7.114 25.484 7.114z"/><path style="fill:currentColor" d="M2 23c-.551.0-1-.449-1-1V10h3v12c0 .551-.449 1-1 1H2z"/><path style="fill:currentColor" d="M23 23c-.551.0-1-.449-1-1V10h3v12c0 .551-.449 1-1 1H23z"/><path style="fill:currentColor" d="M20 18c-.551.0-1-.449-1-1v-5h2v5C21 17.551 20.551 18 20 18z"/><path style="fill:currentColor" d="M6 18c-.551.0-1-.449-1-1v-5h2v5C7 17.551 6.551 18 6 18z"/></g></svg>
</span></span><span class=dark:text-neutral-300>Vous avez probablement entendu parler de <em>nftables</em>. Elle est juste une ligne de commande qui permet de mettre √† jour plus efficacement qu&rsquo;iptables les r√®gles. Pour cela on a d√ª modifier l&rsquo;&ldquo;api&rdquo; du noyau Linux. Mais le moteur derri√®re reste <em>netfilter</em>.</span></div><p>Malgr√© ses qualit√©s, Linux n&rsquo;a jamais eu bonne presse pour le mat√©riel r√©seau. Par exemple, la plupart des switchs et routeurs professionnels tournent sous d&rsquo;autres syst√®mes d&rsquo;exploitation. Est-ce qu&rsquo;XDP pourrait inverser la tendance ?</p><h3 class="relative group">XDP : le successeur ?<div id=xdp--le-successeur- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#xdp--le-successeur- aria-label=Ancre>#</a></span></h3><p>En 2014, eBPF est sortie. Mais c&rsquo;est deux ans plus tard, pour la version 4.8 du noyau Linux que XDP √©tait enfin utilisable. Il a √©t√© d√©velopp√© conjointement par Brenden Blanco (<a href=https://ventures.swisscom.com/portfolio/plumgrid/ target=_blank>PLUMgrid Inc</a>) et Tom Herbert (Facebook).</p><p>Contrairement √† d&rsquo;autres types de programme eBPF, XDP ne peut s&rsquo;utiliser uniquement avec eBPF. Un hook est plac√© au niveau du driver r√©seau permettant ainsi de d√©marrer son programme eBPF. Ainsi il fallait d√©velopper les drivers compatibles XDP pour que cela puisse fonctionner.
Il fallait √©galement que les frameworks de l&rsquo;√©poque puissent g√©rer ce nouveau type de programme. Ainsi d√®s juillet 2016, avant m√™me la sortie officiel du noyau Linux compatible avec XDP, il √©tait possible de cr√©er des programmes XDP avec BCC :</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="BCC PR" src=https://blog.littlejo.link/assets/screenshot/xdp/bcc.webp></figure></p><p>Depuis, XDP a continu√© d&rsquo;√©voluer, on peut noter :</p><ul><li>en 2018, l&rsquo;apparition de la socket <a href=https://docs.ebpf.io/linux/concepts/af_xdp/ target=_blank><code>AF_XDP</code></a> (<em>Address Family Express Data Path</em>) qui permet d&rsquo;exploiter XDP depuis l&rsquo;espace utilisateur sans passer par la pile r√©seau.</li><li>en 2022, la gestion des paquets importants (comme Jumbo packet, GRO ou BIG TCP) avec <a href=https://docs.ebpf.io/linux/program-type/BPF_PROG_TYPE_XDP/#xdp-fragments target=_blank><em>XDP Fragment</em></a>.</li></ul><p>Aujourd&rsquo;hui, XDP est consid√©r√© comme stable et utilisable en production.</p><div class="flex px-4 py-3 rounded-md
alert-warning"><span class="pe-3 flex items-center
alert-icon-warning"><span class="relative block icon"><svg height="800" width="800" id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 26 26"><g><path style="fill:currentColor" d="M25.484 7.114l-4.278-3.917C21.034 3.069 20.825 3 20.61 3H5.38c-.215.0-.424.069-.597.197l-4.38 4C.403 7.197.0 7.453.0 8v2c0 .551.449 1 1 1h24c.551.0 1-.449 1-1V8C26 7.469 25.484 7.114 25.484 7.114z"/><path style="fill:currentColor" d="M2 23c-.551.0-1-.449-1-1V10h3v12c0 .551-.449 1-1 1H2z"/><path style="fill:currentColor" d="M23 23c-.551.0-1-.449-1-1V10h3v12c0 .551-.449 1-1 1H23z"/><path style="fill:currentColor" d="M20 18c-.551.0-1-.449-1-1v-5h2v5C21 17.551 20.551 18 20 18z"/><path style="fill:currentColor" d="M6 18c-.551.0-1-.449-1-1v-5h2v5C7 17.551 6.551 18 6 18z"/></g></svg>
</span></span><span class=dark:text-neutral-300>On ne peut pas dire qu&rsquo;XDP est un rempla√ßant de Netfilter. Par exemple, recr√©er une commande √©quivalente √† <code>iptables</code> avec XDP serait un travail colossal. Le projet <a href=https://bpfilter.io/ target=_blank>bpfilter</a> est un projet qui vise √† traduire les r√®gles iptables en programmes eBPF n&rsquo;utilise pas uniquement XDP.</span></div><p>Pour finir, voici une petite frise chronologique de l&rsquo;histoire de XDP :</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="XDP history" src=https://blog.littlejo.link/assets/svg/xdp/history.svg></figure></p><p>Maintenant qu&rsquo;XDP est jug√©e stable, on peut se poser une question bien l√©gitime : quels projets utilisent XDP ?</p><hr><h2 class="relative group">Quels projets utilisent XDP ?<div id=quels-projets-utilisent-xdp- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#quels-projets-utilisent-xdp- aria-label=Ancre>#</a></span></h2><p>Pour d√©fier le lieu commun : &ldquo;eBPF c&rsquo;est utilis√© que par 3 grosses bo√Ætes&rdquo;, j&rsquo;ai fait une petite recherche des outils qui utilisaient r√©ellement XDP et que donc vous l&rsquo;utilisiez peut-√™tre sans le savoir&mldr;</p><h3 class="relative group">Katran : le loadbalancer de Facebook<div id=katran--le-loadbalancer-de-facebook class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#katran--le-loadbalancer-de-facebook aria-label=Ancre>#</a></span></h3><p>Le projet <a href=https://github.com/facebookincubator/katran target=_blank>Katran</a> d√©veloppe un load balancer XDP de niveau 4. Il est utilis√© par Facebook mais √©galement par Netflix. Par ailleurs, Facebook a cr√©√© <a href=https://cilium.io/blog/2018/11/20/fb-bpf-firewall/ target=_blank>un firewall bas√© sur XDP pour emp√™cher le DDoS</a>.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=Katran src=https://blog.littlejo.link/assets/screenshot/xdp/katran.webp></figure></p><h3 class="relative group">Cilium : les services externes de Kubernetes<div id=cilium--les-services-externes-de-kubernetes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#cilium--les-services-externes-de-kubernetes aria-label=Ancre>#</a></span></h3><p>Le projet <a href=https://cilium.io/ target=_blank>Cilium</a> fournit un plugin CNI pour Kubernetes et peut √©galement remplacer kube-proxy. Selon <a href=https://docs.cilium.io/en/stable/operations/performance/tuning/#xdp-acceleration target=_blank>certaines conditions</a>, Cilium peut activer XDP pour les services de type <strong>NodePort</strong>, <strong>LoadBalancer</strong> et <strong>externalIPs</strong>, permettant ainsi d&rsquo;√™tre plus performant.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=Cilium src=https://blog.littlejo.link/assets/screenshot/xdp/cilium.webp></figure></p><h3 class="relative group">Cloudflare : pour emp√™cher le DDoS<div id=cloudflare--pour-emp√™cher-le-ddos class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#cloudflare--pour-emp%c3%aacher-le-ddos aria-label=Ancre>#</a></span></h3><p>En 2018, Cloudflare a publi√© <a href=https://blog.cloudflare.com/l4drop-xdp-ebpf-based-ddos-mitigations/ target=_blank>un article expliquant comment il r√©duisait le DDoS avec XDP</a>. R√©cemment Cloudflare a communiqu√© pour <a href=https://securityaffairs.com/182521/security/cloudflare-mitigates-largest-ever-ddos-attack-at-22-2-tbps.html target=_blank>avoir d√©jou√© un DDoS de 22,2 Tbit/s</a>.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=Cloudflare src=https://blog.littlejo.link/assets/screenshot/xdp/cloudflare.webp></figure></p><h3 class="relative group">Et bien d&rsquo;autres<div id=et-bien-dautres class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#et-bien-dautres aria-label=Ancre>#</a></span></h3><p>Il y a certainement d&rsquo;autres projets moins connus qui utilisent XDP comme <a href=https://docs.suricata.io/en/latest/capture-hardware/ebpf-xdp.html target=_blank>Surricata</a>.</p><p>Nous allons maintenant voir les principales difficult√©s que l&rsquo;on va rencontrer quand on va commencer √† cr√©er un programme XDP.</p><hr><h2 class="relative group">Comment d√©buter son programme XDP ?<div id=comment-d√©buter-son-programme-xdp- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#comment-d%c3%a9buter-son-programme-xdp- aria-label=Ancre>#</a></span></h2><p>Pour de nombreux programmes eBPF, la premi√®re difficult√© est de trouver le point d&rsquo;accroche. Pour XDP, c&rsquo;est relativement simple : il suffit de conna√Ætre le nom de l&rsquo;interface r√©seau o√π on veut accrocher le programme XDP.</p><p>La r√©elle difficult√© r√©side plut√¥t dans la cr√©ation d&rsquo;un environnement r√©seau. La solution <em>traditionnelle</em> est de cr√©er des VMs (avec Vagrant par exemple) et de les faire communiquer entre eux. Cette solution est tout √† fait possible pour XDP mais √ßa me para√Æt un peu lourd √† mettre en place (par exemple pour les labs).</p><p>Pour la suite, je vous propose une solution beaucoup plus l√©g√®re : en utilisant les <em>namespaces</em> r√©seaux de Linux. Le m√™me m√©canisme qui est utilis√© pour Docker.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=Namespace src=https://blog.littlejo.link/assets/screenshot/xdp/namespace.webp></figure></p><h3 class="relative group">Cr√©ation d&rsquo;un environnement pour XDP<div id=cr√©ation-dun-environnement-pour-xdp class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#cr%c3%a9ation-dun-environnement-pour-xdp aria-label=Ancre>#</a></span></h3><div class="flex px-4 py-3 rounded-md
alert-tip"><span class="pe-3 flex items-center
alert-icon-tip"><span class="relative block icon"><svg fill="currentColor" width="800" height="800" viewBox="-2 -2 36 36"><title>lab</title><path d="M19.332 19.041s-1.664 2.125-3.79.0c-2.062-2-3.562.0-3.562.0l-4.967 9.79c-.144.533.173 1.081.706 1.224h16.497c.533-.143.85-.69.707-1.224l-5.591-9.79zm7.607 9.289-7.979-13.428v-.025l-.014-7.869h.551c.826.0 1.498-.671 1.498-1.499.0-.827-.672-1.498-1.498-1.498h-7.995c-.827.0-1.498.671-1.498 1.498.0.828.671 1.499 1.498 1.499h.482l-.016 7.871L5.06 28.33c-.428 1.599.521 3.242 2.119 3.67H24.82c1.6-.428 2.549-2.071 2.119-3.67zm-2.386 2.668-17.108-.019c-1.065-.286-1.697-1.382-1.412-2.446l6.947-13.616.021-8.908h-1.498c-.275.0-.499-.224-.499-.5s.224-.499.499-.499h7.995c.275.0.498.224.498.499.0.276-.223.5-.498.5H18l.025 8.875 7.939 13.666c.286 1.067-.347 2.163-1.411 2.448zM16.48 2.512c0 .552.448 1 1 1s1-.448 1-1-.447-1-1-1-1 .447-1 1zm-3 0c.553.0 1-.448 1-1s-.447-1-1-1-1 .448-1 1 .447 1 1 1z"/></svg>
</span></span><span class=dark:text-neutral-300><p>Je suppose que vous √™tes sous Linux pour la d√©monstration.
Si ce n&rsquo;est pas le cas, vous pouvez utiliser le lab Killercoda :</p><p><a href=https://killercoda.com/littlejo/course/aya-prod/aya-xdp target=_blank><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Killer coda screenshot" src=https://blog.littlejo.link/assets/screenshot/xdp/killercoda.webp></figure></a></p></span></div><h4 class="relative group">Script de cr√©ation de l&rsquo;environnement<div id=script-de-cr√©ation-de-lenvironnement class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#script-de-cr%c3%a9ation-de-lenvironnement aria-label=Ancre>#</a></span></h4><p>On pourrait faire un tutoriel pour la cr√©ation de <em>namespaces</em> r√©seaux mais comme ce n&rsquo;est pas le sujet central et comme il y a d√©j√† des scripts qu&rsquo;on peut facilement trouver sur le net, je vous propose le script suivant :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>git</span> clone https://github.com/littlejo/eunomia.dev
</span></span><span class=line><span class=cl><span class=k>cd</span> eunomia.dev/docs/tutorials/<span class=m>42</span>-xdp-loadbalancer/
</span></span></code></pre></div><p>Pour cr√©er les <em>namespaces</em> r√©seaux :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl>./setup.sh
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md
alert-tip"><span class="pe-3 flex items-center
alert-icon-tip"><span class="relative block icon"><!doctype html><svg height="800" width="800" id="_x32_" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512"><style>.st0{fill:currentColor}</style><g><path class="st0" d="M456.967 17.542s-27.005-39.468-99.721.0c-21.912 11.9-110.116 69.414-192.168 70.648-69.594 1.031-121.542-56.1-109.07-6.244 13.69 54.761 105.949 398.897 105.949 398.897h-22.852V512h112.192L112.101 125.589s34.068 6.379 89.333 2.069c66.48-5.198 120.496-49.864 162.048-33.24 41.553 16.624-20.775 220.225-126.732 334.478l12.472 37.4C249.221 466.296 473.591 283.47 456.967 17.542z"/><path class="st0" d="M146.145 195.613l5.883 16.33 36.835-75.146c-4.738.248-9.455.444-14.126.519l-28.592 58.297z"/><path class="st0" d="M250.921 126.01c-5.266 1.625-10.621 3.13-16.082 4.468l-64.63 131.892 5.882 16.324 74.83-152.684z"/><path class="st0" d="M319.063 102.744c-5.28 1.392-10.704 3.136-16.375 5.092h-.016L194.242 329.092l5.882 16.338L319.063 102.744z"/><polygon class="st0" points="367.784,119.202 367.784,119.18 361.843,102.978 218.283,395.85 224.165,412.158"/></g></svg>
</span></span><span class=dark:text-neutral-300>J&rsquo;ai d√ª installer le paquet <code>net-tools</code> sous Debian pour avoir acc√®s √† la commande <code>arp</code> qui est utilis√©e dans le script pour effectuer des v√©rifications de bon fonctionnement.</span></div><p>Ce script va cr√©er trois <em>namespaces</em> qui peuvent communiquer entre eux (<code>lb</code>, <code>h2</code> et <code>h3</code>) via un bridge (<code>br0</code>) :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>ip</span> netns list
</span></span></code></pre></div><pre tabindex=0><code>lb (id: 23)
h3 (id: 18)
h2 (id: 15)
</code></pre><p>Pour voir les IPs d&rsquo;un namespace, on peut taper :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>ip</span> netns <span class=nb>exec </span>lb ip <span class=na>-brief</span> <span class=na>-family</span> inet addr
</span></span></code></pre></div><pre tabindex=0><code>lo               UNKNOWN        127.0.0.1/8
veth6@if98       UP             10.0.0.10/24
</code></pre><div class="flex px-4 py-3 rounded-md
alert-info"><span class="pe-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1.0h-66.1v60.1h66.1v-60.1zm276.8 1e2c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4.0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1.0h-66.1v59.4h66.1v-59.4zm78.1.0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg></span>
</span><span class=dark:text-neutral-300>Il faut voir ces <em>namespaces</em> un peu comme des <em>containers</em> √† part qu&rsquo;√† l&rsquo;int√©rieur des <em>namespaces</em> on a toutes les commandes de l&rsquo;h√¥te !</span></div><p>On peut repr√©senter de cette mani√®re ces <em>namespaces</em> :</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=namepaces src=https://blog.littlejo.link/assets/svg/xdp/namespaces.svg></figure></p><h4 class="relative group">V√©rification du bon fonctionnement<div id=v√©rification-du-bon-fonctionnement class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#v%c3%a9rification-du-bon-fonctionnement aria-label=Ancre>#</a></span></h4><p>Bien que le script fait d√©j√† les v√©rifications n√©cessaires, on va tout de m√™me en faire quelques uns nous m√™me pour montrer les possibilit√©s de tests qu&rsquo;on peut faire.</p><p>On peut ainsi pinger l&rsquo;ip d&rsquo;un <em>namespace</em> depuis l&rsquo;h√¥te :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>ping</span> <span class=na>-c</span> <span class=m>3</span> <span class=m>10</span>.<span class=m>0</span>.<span class=m>0</span>.<span class=m>10</span>
</span></span></code></pre></div><p>√áa ping bien :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>PING 10.0.0.10 (10.0.0.10) 56(84) bytes of data.
</span></span><span class=line><span class=cl>64 bytes from 10.0.0.10: icmp_seq=1 ttl=64 time=0.060 ms
</span></span><span class=line><span class=cl>64 bytes from 10.0.0.10: icmp_seq=2 ttl=64 time=0.124 ms
</span></span><span class=line><span class=cl>64 bytes from 10.0.0.10: icmp_seq=3 ttl=64 time=0.122 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.0.0.10 ping statistics ---
</span></span><span class="line hl"><span class=cl>3 packets transmitted, 3 received, 0% packet loss, time 2053ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev = 0.060/0.102/0.124/0.029 ms
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=namepaces src=https://blog.littlejo.link/assets/svg/xdp/namespaces-ping.svg></figure></p><p>Pour tester la connexions √† un serveur web dans un <em>namespace</em>, je peux le faire de cette mani√®re dans le <em>namespace</em> <code>h2</code> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>ip</span> netns <span class=nb>exec </span>h2 python3 <span class=na>-m</span> http.server <span class=m>8080</span>
</span></span></code></pre></div><p>Si je veux tester que depuis <code>lb</code>, je peux me connecter au serveur web, je tape sur un autre terminal :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>ip</span> netns <span class=nb>exec </span>lb curl http://<span class=m>10</span>.<span class=m>0</span>.<span class=m>0</span>.<span class=m>2</span>:<span class=m>8080</span>
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=namepaces src=https://blog.littlejo.link/assets/svg/xdp/namespaces-http.svg></figure></p><div class="flex px-4 py-3 rounded-md
alert-info"><span class="pe-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg fill="currentColor" width="800" height="800" viewBox="0 0 20 20"><path d="M17 12h-6v4h1v4H8v-4h1v-4H3v4h1v4H0v-4h1v-4a2 2 0 012-2h6V6H7V0h6v6h-2v4h6a2 2 0 012 2v4h1v4h-4v-4h1v-4z"/></svg>
</span></span><span class=dark:text-neutral-300>On pourra ainsi cr√©er un petit load balancer dans le <em>namespace</em> <code>lb</code> et le rediriger vers le <em>namespace</em> <code>h2</code> et <code>h3</code>.</span></div><p>On a ainsi un environnement de test complet pour la suite des articles.</p><h4 class="relative group">Nettoyage<div id=nettoyage class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#nettoyage aria-label=Ancre>#</a></span></h4><p>Pour supprimer les <em>namespaces</em> et les interfaces r√©seaux, on peut red√©marrer la machine ou juste taper :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl>./teardown.sh
</span></span></code></pre></div><h3 class="relative group">Mon premier programme xdp<div id=mon-premier-programme-xdp class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#mon-premier-programme-xdp aria-label=Ancre>#</a></span></h3><p>Nous allons maintenant cr√©er un petit programme XDP dans l&rsquo;environnement cr√©√©.</p><p><code>xdp-tools</code> est une suite d&rsquo;outils pour cr√©er et debugger des programmes XDP.</p><p>Pour l&rsquo;installer sous Debian 13, j&rsquo;ai install√© le paquet :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>apt</span> install xdp-tools
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md
alert-tip"><span class="pe-3 flex items-center
alert-icon-tip"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1.0h-66.1v60.1h66.1v-60.1zm276.8 1e2c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4.0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1.0h-66.1v59.4h66.1v-59.4zm78.1.0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg></span>
</span><span class=dark:text-neutral-300>Si vous gal√©rez pour l&rsquo;installer j&rsquo;ai cr√©√© un container pour cela (<code>littlejo/xdp-tools</code>). Tout est <a href=https://github.com/xdp-project/xdp-tools/tree/main/packaging/docker target=_blank>l√†</a>.</span></div><p>On va utiliser <code>xdp-filter</code> qui permet de cr√©er des programmes xdp qui filtrent les paquets.</p><p>On va installer un programme xdp sur l&rsquo;interface veth0 :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>xdp-filter</span> load veth0
</span></span></code></pre></div><p>L&rsquo;option <em>load</em> permet de charger le programme XDP.</p><div class="flex px-4 py-3 rounded-md
alert-info"><span class="pe-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg width="35.895355" height="36.001198" viewBox="0 0 35.895355 36.001198" fill="none" id="svg13"><path fill-rule="evenodd" clip-rule="evenodd" d="m23.6364.10692772c.484.244422.6756.829517.4279 1.30684198-.489.9425-.7536 2.29434-.8548 3.68384-.0998 1.37144-.0333 2.66933.0689 3.4332.0712.53167-.308 1.01948-.847 1.08955s-1.0337-.30413-1.1048-.83581c-.1203-.89834-.1899-2.32813-.0808-3.82659.1078-1.4804.3972-3.14069 1.0658-4.42931998.2477-.4773282.8408-.666135 1.3248-.421712z" fill="#1a1a1a" id="path1"/><path d="m17.9279 15.4786c.591-2.7701-5.4162-3.2222-8.49374-3.1019-12.13253.2574-7.06117 7.5956-.344 8.4137 2.76434.3367 8.09894-1.8492 8.83774-5.3118z" fill="currentColor" id="path2"/><path d="m3.00152 13.9149c.34054-.2771.78266-.5279 1.33721-.743l.17291.5359.88014 1.0998 1.28927 1.153.9905-.145 4.95105-.5064 5.2045.5492c-.1637.515-.4287.9991-.7694 1.4477C15.5173 17.0017 11.9211 16.9114 9.96784 16.9078 9.44518 17.5136 9.25598 19.5736 9.2151 20.8038 9.17288 20.7999 9.1312 20.7954 9.09009 20.7904 8.54185 20.7236 8.00457 20.6134 7.48672 20.4672 7.43882 19.5053 7.77515 18.1299 8.01989 17.3664 6.48879 17.4486 4.86925 18.1947 3.97602 18.7145 3.56434 18.3884 3.20739 18.0402 2.91797 17.6812l1.98456-1.0757C4.59621 16.4519 3.62819 14.9452 3.00152 13.9149z" fill="currentColor" id="path3"/><path d="M16.8986 18.8203l1.7838 1.1899-8.0602 11.7636-1.9367-1.2919-1.48753-2.1642-.74485-3.5732 1.33387-3.1389 3.20141.9634z" fill="currentColor" id="path4"/><path fill-rule="evenodd" clip-rule="evenodd" d="M15.2758 11.0042c2.3911-5.0861403 8.2076-3.8391103 10.9546-2.0068003L18.6815 20.0147 17.8151 19.4368c-1.1 1.2586-3.3469 2.2113-4.3328 2.5303.1001 1.4145 1.3034 2.5052 1.8925 2.8737l-2.4801 3.6196c-2.89488-1.931-3.74047-4.6925-3.80141-5.8318l-1.0745-.0575c-1.89715 4.2428 1.07775 7.5309 2.91251 8.7548L7.72792 36.0012 8.28497 31.6116c-3.61109-3.0533-2.96504-7.6667-2.19063-9.5917C3.60654 21.5324-.71116398 17.9714.09996132 14.9451 1.51225 9.6757097 10.7796 9.7630597 15.2758 11.0042zm2.6538 4.4605c.5621-2.7545-5.4263-3.2044-8.49737-3.0844-1.95229.0414-3.45912.2662-4.5853.6176.50118 1.5357 1.66332 2.2994 2.22769 2.4976 3.56078-.7988 8.18428-.4303 10.85498-.0308zM17.705 16.192c-1.8625-.2387-4.6377-.3002-6.0775-.2966-1.95525 1.3169-2.20603 3.5377-2.03968 4.9319 2.64838.0449 6.94048-1.776 8.11718-4.6353zm-9.01016 4.5464c-.35729-2.0196.79278-3.9252 1.49856-4.7008-3.62095.1363-5.90362 1.15-7.01878 1.9457 1.19325 1.2879 3.24214 2.3888 5.52022 2.7551zM2.5405 17.15c.89512-.5396 2.4988-1.0361 3.3714-1.2581-1.26155-.9307-1.8124-1.9023-2.00718-2.5311-1.97331.9358-2.197 2.4008-1.36422 3.7892z" fill="#1a1a1a" id="path5"/><path fill-rule="evenodd" clip-rule="evenodd" d="m35.5569 8.0548297c-.4102-.35197-1.0318-.30931-1.3885.09529-.7042.79888-1.8771 1.54484-3.1462 2.1552803-1.2527.6024-2.4981 1.0253-3.2547 1.2163-.5265.1329-.844.6619-.7091 1.1814.1349.5195.6711.8329 1.1977.6999.8897-.2246 2.2604-.6937 3.6291-1.352 1.3521-.6503 2.8058-1.534 3.7687-2.6262703.3566-.4046.3132-1.01792-.097-1.3699z" fill="#1a1a1a" id="path6"/><path d="m23.2275 19.0151c2.385-1.5734 5.0488 3.7584 6.0825 6.621 4.2791 11.2045-4.5124 9.2957-7.785 3.4503-1.3468-2.4055-1.2788-8.1045 1.7025-10.0713z" fill="currentColor" id="path7"/><path d="m30.2594 32.1c.1337-.4151.2048-.9133.2005-1.5012L29.8914 30.6402 28.529 30.2441 26.9642 29.4933 26.7315 28.5324l-1.3687-4.7219L22.9067 19.25c-.4233.3418-.7798.7648-1.0748 1.2439.8604 1.297 2.2853 4.556 3.0167 6.343-.3751.7043-2.242 1.6452-3.3838 2.1411.0194.0372.0392.0737.0592.1095.2671.477.571.9279.9015 1.3475.9225-.3145 2.0908-1.135 2.7176-1.6436.4933 1.4325.3951 3.1933.2391 4.2049.4601.2554.9206.4525 1.3661.5837l.2722-2.2179c.2586.2232 2.0364.548 3.2389.7379z" fill="currentColor" id="path8"/><path d="m20.4651 21.1977-1.7838-1.1899-8.0602 11.7636 1.9367 1.2919 2.5898.5554 3.6382-.6495 2.4552-2.391-2.0992-2.5722z" fill="currentColor" id="path9"/><path fill-rule="evenodd" clip-rule="evenodd" d="M28.4238 19.774C32.3164 15.6893 28.976 10.8284 26.229 8.9960897L18.6802 20.0134l.8664.578c-.7738 1.4761-.8325 3.8884-.7651 4.9099-1.3678.4355-2.8419-.2597-3.4081-.6618l-2.48 3.6196c2.8948 1.931 5.8072 1.6761 6.9015 1.3073l.4544.9624c-3.2834 3.3181-7.4845 1.8196-9.3193.5958l-3.20344 4.6753 3.92084-2.1458c4.2173 2.1685 8.3155-.1422 9.8375-1.5687 1.3855 2.0962 6.3437 4.7225 8.8878 2.8521 4.4296-3.2567.8939-11.7094-1.9489-15.3635zm-5.1841-.7677c2.3812-1.5411 5.036 3.7742 6.0675 6.6308.6886 1.8029 1.0387 3.2663 1.1278 4.4284-1.6311.1134-2.7824-.666-3.1791-1.1089-.5757-3.5579-2.6452-7.6538-4.0162-9.9503zm-.6003.4767c.9185 1.6163 2.0106 4.1343 2.5437 5.4541-.51 2.2809-2.5052 3.3381-3.8784 3.7053-1.0291-2.4081-.916-7.0166 1.3347-9.1594zm-.9184 9.9439c2.0327-.4255 3.3963-2.1886 3.8628-3.1238 1.2211 3.3661 1.1184 5.8339.7856 7.1514-1.656-.6126-3.4549-2.0783-4.6484-4.0276zm5.6684 4.2977c.174-1.0207.0433-2.674-.073-3.5557 1.3454.8082 2.4645.9505 3.1284.8946-.1447 2.1554-1.4393 2.9062-3.0554 2.6611z" fill="#1a1a1a" id="path10"/></svg>
</span></span><span class=dark:text-neutral-300>Pour le d√©charger, il suffit d&rsquo;utiliser l&rsquo;option <code>unload</code> : <code>xdp-filter unload veth0</code>.</span></div><p>Voil√† ce qu&rsquo;on a fait sch√©matiquement :</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="namepaces xdp" src=https://blog.littlejo.link/assets/svg/xdp/namespaces-xdp.svg></figure></p><p>Depuis un autre terminal, on peut v√©rifier que le ping fonctionne :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>ip</span> netns <span class=nb>exec </span>lb ping <span class=na>-c</span> <span class=m>3</span> <span class=m>10</span>.<span class=m>0</span>.<span class=m>0</span>.<span class=m>1</span>
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="namepaces xdp" src=https://blog.littlejo.link/assets/svg/xdp/namespaces-xdp-ping.svg></figure></p><p>Vous pouvez √©galement le voir :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>xdp-filter</span> <span class=nb>status</span>
</span></span></code></pre></div><p>Vous voyez qu&rsquo;xdp a bien laiss√© passer 3 packets :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>CURRENT XDP-FILTER STATUS:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Aggregate per-action statistics:
</span></span><span class=line><span class=cl>  XDP_ABORTED                                   0 pkts           0 KiB
</span></span><span class=line><span class=cl>  XDP_DROP                                      0 pkts           0 KiB
</span></span><span class="line hl"><span class=cl>  XDP_PASS                                      3 pkts           0 KiB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Loaded on interfaces:
</span></span><span class=line><span class=cl>                                           Enabled features
</span></span><span class=line><span class=cl>xdpfilt_alw_all
</span></span><span class=line><span class=cl>  veth0 (native mode)                      tcp,udp,ipv6,ipv4,ethernet,allow
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Filtered ports:
</span></span><span class=line><span class=cl>                                           Mode             Hit counter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Filtered IP addresses:
</span></span><span class=line><span class=cl>                                           Mode             Hit counter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Filtered MAC addresses:
</span></span><span class=line><span class=cl>                                           Mode             Hit counter
</span></span></code></pre></div><p>Pour filtrer l&rsquo;ip de lb :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>xdp-filter</span> ip <span class=na>-m</span> src <span class=m>10</span>.<span class=m>0</span>.<span class=m>0</span>.<span class=m>10</span>
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="namepaces xdp" src=https://blog.littlejo.link/assets/svg/xdp/namespaces-xdp-ping-not.svg></figure></p><div class="flex px-4 py-3 rounded-md
alert-info"><span class="pe-3 flex items-center
alert-icon-info"><span class="relative block icon"><svg version="1.0" width="124.2pt" height="130.97134pt" viewBox="0 0 124.2 130.97134" preserveAspectRatio="xMidYMid" id="svg24"><g transform="matrix(0.1,0,0,-0.1,-77.8,210.97132)" fill="currentColor" stroke="none" id="g24"><path d="m1368 2104c-4-3-17-7-30-8-43-5-137-36-144-48-4-6-10-53-13-105-5-71-3-93 6-93 18 0 16-17-2-24-23-9-20-129 5-185 17-37 22-41 35-31 13 11 15 8 15-21v-34h-1e2c-55 0-1e2 3-1e2 6s18 48 40 99c38 90 50 137 31 126-5-3-8 2-7 12 1 15-8 17-82 14-45-2-101-6-125-10l-42-7-3-69c-2-38 1-73 6-78 6-6-5-46-25-101-19-51-37-99-40-108-2-9 5-36 17-59l21-42 165 4c111 3 164 1 164-6 0-6 3-20 6-31 5-19 1-20-80-16-78 3-86 1-86-15-1-18-1-18-14-1-10 13-28 17-77 17-69 0-72-2-108-42l-23-27 82-150c79-145 81-151 78-208l-3-58 129-3c128-3 156 3 156 33 0 7-9 15-20 18s-20 13-20 22c0 14 3 15 15 5 20-17 19-12-10 66-14 36-25 70-25 75s15 9 33 9c33 0 33 0 63-92l29-93 117-2 116-3 30 90c24 71 28 90 16 90-8 0-14 5-14 10 0 16 33 26 38 12 2-7 17-12 33-12s29-1 29-2c0-2-16-45-35-96-49-133-50-132 120-132h135v66c0 63 3 72 75 204 41 76 75 145 75 153s-14 27-30 41c-30 25-34 25-185 24-105 0-153-4-148-11 3-6 1-7-5-3-7 4-12 2-12-4s-4-9-8-6c-4 2-8-4-8-15 0-10 4-19 8-19s8 5 8 11c0 7 12 0 27-15 22-23 25-29 13-37-11-6-12-9-2-9 8 0 10-5 6-12s-4-10 1-6c4 4 15 2 23-5 13-9 14-9 8 1-4 7-1 12 8 12s16-4 16-9c0-9-31-38-36-33-21 16-74 40-68 30 4-7 9-23 10-36 3-24 3-24-19-6-12 10-28 25-34 33-11 12-15 12-32-3-16-15-19-32-11-56 1-3 5 6 9 19 10 38 26 35 27-4 0-23-3-31-8-23-6 10-11 9-22-5s-15-15-19-5c-3 8-6 6-6-6-1-13-6-16-17-12-14 6-15 4-4-9 13-16 21-107 9-99-4 2-13-4-20-13-8-10-9-14-2-10 6 4 14 3 17-2 4-6-8-8-29-5-21 2-35 0-35-6s8-10 17-8c10 2 19-4 21-14s-2-18-8-18-8 4-5 10c3 5-1 10-10 10-11 0-15-5-12-14 7-17-27-16-58 2-32 17-86 32-80 22 3-6 0-7-8-4s-13 18-12 39c0 19-1 32-4 30-5-6-30 27-31 40 0 6 5 3 10-5 8-13 10-13 10 1 0 29-69 65-125 64-27 0-53 4-56 8-5 7-9-26-9-65 1-30 7-65 14-76 12-20 15-51 6-57-5-3-7-12-3-20 3-8 1-15-3-16-63-8-114-7-109 1 3 5 0 7-8 4-10-3-13 4-13 31 1 24 5 34 14 30 7-3 10 0 7 6-4 5-15 7-26 4-23-8-24 1-3 22 13 13 13 17 2 24-7 5-9 9-4 9 6 0 1 7-10 16-14 12-15 14-3 11 14-5 15-2 5 19-6 13-16 22-23 20-7-3-10 1-6 10 3 7 9 14 14 14s1 8-8 18c-10 11-22 17-26 14-5-2 0-10 10-18 10-7 13-14 6-14-6 0-15 5-19 11-4 8-9 7-15-2-7-11-9-10-9 4 0 9 4 17 9 17s11 9 14 20c3 12 11 18 19 15 7-3 22 2 33 10 19 15 19 16-3 5-33-16-40-4-12 20 22 19 24 19 37 2 7-9 13-12 12-7-4 26 2 37 17 31 8-3 12-2 9 3-3 6 2 14 11 19 10 6 13 12 6 16-13 8-44-3-37-14 3-4-2-13-11-20-13-12-14-10-10 14 4 23 2 26-15 21-11-4-19-2-19 4s3 11 8 12c48 5 78 3 84-5 4-6 11-6 20 1 10 8 42 10 66 4 2-1-6-14-17-30-13-18-16-29-8-28 35 1 48-4 41-15-5-9-3-9 9 1 21 17 13 31-13 24-12-3-20 0-20 7 0 8 11 11 30 8 21-3 27-1 20 6-18 18-11 42 15 54s33 36 14 48c-8 4-7 9 2 15 11 8 11 11-3 20-24 14-23 19 12 56 17 18 26 34 20 38-12 7-72-40-63-49 4-3 1-6-5-6-19 0-23 19-10 42 7 13 11 26 10 31-4 14 49 7 76-10l27-17-19 22c-18 21-18 22 3 57 11 20 21 45 21 55s5 22 10 25c8 5 7 11 0 20-7 8-9 18-6 24 10 16-5 42-30 52-13 4-24 13-24 19 0 7 6 8 19 0 21-11 37 2 26 20-3 6-2 10 4 10 10 0 41-51 41-67 0-4-9 3-20 17s-20 20-20 14c0-7 8-22 18-33 14-18 21-20 42-12 19 7 21 10 6 10-12 1-16 6-12 17 3 9 6 18 6 20 0 3 5 2 10-1 6-4 8-11 5-16-4-5-1-9 4-9 14 0 14 17 1 25-18 11-11 23 10 18 11-3 17-9 14-14s0-8 7-7c22 5 20-19-2-25-17-5-21-11-17-32 7-33-9-43-21-13-6 13-10 17-10 9-1-8-8-11-19-9-11 3-19 0-19-8 0-7 3-11 7-9s7-2 7-10-5-13-10-12-11-9-13-23c-3-21-2-22 7-7 5 9 15 17 22 17s6-4-3-10c-13-8-12-10 3-10 9 0 17-4 17-9 0-16 39-8 46 9 4 8 8 18 8 22 2 16 17 20 31 8 17-14 50-6 40 10-3 5-1 10 4 10 6 0 11 5 11 11 0 5-5 7-10 4-6-3-13 1-16 10-5 13-9 14-15 4-5-8-2-21 8-31 9-10 11-18 5-18-15 0-35 38-28 56 3 8 1 14-4 14-6 0-10-7-10-15 0-9-6-12-15-9-20 8-19 34 0 34 22 0 30 27 14 47-13 15-11 16 9 10 13-3 21-3 18 0s2 12 12 19c16 12 16 12-3 11-14-1-20 4-19 16 2 15-1 16-14 5s-14-10-3 9c10 19 9 22-4 17-8-4-15-1-15 5s-10 11-23 11-28 5-35 12c-9 9-12 7-12-10 0-12-5-22-11-22s-23-9-38-19c-22-16-29-17-44-7-22 17-10 28 14 15 15-7 21-6 25 6 3 8 12 15 18 15 18 0 15 83-4 94-12 8-11 11 5 17 18 7 18 8 2 8-10 1-15 5-12 11 3 5 0 7-8 4s-18-1-22 5c-3 6-1 11 4 11 6 0 11 5 11 11 0 5-4 8-9 4-5-3-12-1-15 4-4 5 2 12 13 16 13 4 18 13 16 25s1 17 9 14c7-3 19 2 26 11 15 18 37 20 42 3 3-7 12-6 31 6 14 10 32 16 39 13 7-2-8-14-35-27-56-27-62-34-41-51 14-12 14-14-3-20-15-7-14-8 7-9 14-2 31-2 39-1 7 2 10-2 6-8-3-6-2-11 4-11 5 0 13 5 16 10 3 6 11 10 17 10 7 0 6-6-2-15-17-20-5-19 16 2 19 19 54 25 51 9-1-6-14-18-28-26-21-12-25-19-18-35 4-11 8-14 8-7 2 23 41 13 51-14 13-33 13-34-6-34-10 0-14 5-10 16 3 8 2 12-3 9s-11 0-14 7c-2 7-2 2 0-10 3-17 0-22-9-16-7 4-4-2 6-15 11-12 26-19 33-17 7 3 17-4 23-14 6-11 17-20 25-20s12-6 9-14c-4-11 0-13 18-9 21 6 22 5 8-13-14-17-14-18 2-6 9 8 14 20 11 28s0 14 6 14c11 0 14-7 14-35 0-54-4-75-12-70-6 3-8-3-6-15 2-11 1-19-3-19-22 4-30-3-27-22 3-16 1-18-8-10-9 7-13 5-13-8 0-11 6-17 12-14 8 3 11-3 9-14-2-10-4-31-5-48-1-29-2-29-11-6-6 16-6 28 2 37 7 9 8 14 1 14-5 0-12-7-16-15-6-16-49-12-73 8-9 6-13 6-13-2 0-6 14-14 30-17 17-4 30-11 30-16s-5-6-11-2c-6 3-4-5 5-18 9-14 13-28 9-31-3-4 1-7 10-7 16 0 16-3 2-37-13-33-13-36 0-19 8 11 15 25 15 30 0 6 5 4 10-4 9-13 11-13 19 0 6 8 13 11 17 8 3-4-1-15-11-24-14-15-18-15-26-3-7 11-9 10-9-5s5-17 28-11c21 5 24 4 15-6-16-16 5-37 32-31 15 3 17 2 9-7-6-6-19-14-30-16-64-15-87-23-71-24 9-1 17-7 17-13 0-9 4-8 10 2 8 13 10 13 10-2 0-10-7-16-19-15-11 0-17 5-14 11 4 5 1 6-7 1-7-4-16-2-20 6-6 9-14 10-31 3-20-9-21-11-5-17 10-4 15-3 11 3-3 6-2 10 3 10 17 0 21-13 11-32-11-21-3-61 12-53 5 4 9-1 9-10 0-11 5-15 15-11 8 3 14 0 12-6-5-23 33-14 62 16s30 33 19 74c-11 43 0 74 24 69 6-1 13 4 15 11 3 8-1 10-13 5-11-4-15-2-11 4s-3 8-17 6c-20-4-23-1-23 20 0 18 4 24 14 20 8-3 12-12 8-21-4-12-3-12 9-3 10 8 16 9 21 1 3-6 10-8 15-5 4 3 10-5 13-16 5-17-1-24-24-32-32-12-34-19-19-48 16-28 28-23 32 13l3 31 165 1 165 1 22 44c14 27 19 49 14 55s-15 30-22 54c-10 33-17 42-30 39-12-3-16 0-12 9 3 8 9 14 14 14 4 0 2 15-6 33-9 22-11 51-7 92 12 107 10 112-59 120-40 5-65 3-72-4-16-16-27-14-21 4 5 12-3 15-39 15-27 0-49-6-57-15-7-8-9-15-4-15s3-4-4-8c-9-7-4-29 23-96 19-48 41-99 49-114l13-26 12 23c7 12 16 19 22 16 5-4 9-1 9 4 0 6 5 11 11 11s8-9 3-22c-9-31-14-35-23-19-7 11-11 9-19-5-9-17-14-17-32-6-14 9-51 12-108 11-80-2-87-1-90 18-2 13 4 22 17 26 10 2 27 19 36 36 18 35 20 71 16 209-3 85-5 92-22 87-11-4-19-2-19 4s7 11 15 11c11 0 15 12 15 45 0 55-15 67-125 95-80 20-117 25-127 14zm90-54c3-7 0-10-7-6-6 4-11 2-11-3 0-10 14-15 33-12 4 0 7-4 7-9 0-13-31-9-46 5-16 15-13 43 5 40 8-1 17-8 19-15zm36-2c4 6 16 9 28 7 25-5 34-13 24-22-4-4-12-1-17 7-9 13-10 12-5-2 3-10 1-20-5-24-12-7-49 24-49 40 0 6 4 5 9-3s11-9 15-3zm-89-20c-1-13-3-29-4-37s-8-11-21-8c-10 3-21 0-23-7-3-6-8-3-12 8-8 18 7 36 30 36 6 0 4-4-4-9s-9-11-3-15c14-8 25 11 18 29-2 7 0 16 7 19 7 2 13 5 13 5 1 1 0-9-1-21zm151-14c-5-13-4-14 7-6 8 7 17 9 20 5 4-3 2-12-5-20-8-11-7-12 6-7 12 5 15 2 10-10-3-9-9-14-13-12-3 2-15-2-25-9-18-14-18-15 8-26 14-7 26-16 26-21 0-13-18-10-22 4-4 10-10 10-29 0l-24-12 24 6c17 5 21 3 16-6-5-8-4-11 3-6 17 10 24-10 8-23-11-10-16-9-23 3-7 13-10 13-21-4-7-11-8-20-3-20s12 6 15 13c3 6 4 3 3-8-2-12-10-19-20-19-15 2-16-1-5-14s10-14-2-10c-15 5-16 13-6 56 3 12 1 20-3 18-5-3-16 3-25 13-14 16-15 22-5 39 12 20 13 20 30-2 9-11 20-18 24-15 3 4-1 14-10 23s-14 17-11 17c3 1 11 3 16 4 6 1 13 3 18 4 4 1-1 8-11 15-17 13-17 15 5 30 28 20 32 20 24 0zm-52-20c9-23 9-23-29-21-39 2-48 23-12 30 12 2 25 5 28 6 4 0 10-6 13-15zm-244-114c0-5-4-12-10-15-5-3-10-1-10 5s-4 9-9 6c-10-7-23 19-14 28 7 7 43-12 43-24zm10-29c0-14-23-29-36-24-8 3-14 0-14-6s5-11 12-11c6 0 9-2 6-5s-12-3-21 1c-15 5-15 8 0 28 16 21 53 33 53 17zm318-36c1-14-3-25-9-25-5 0-7 5-4 10 8 13-1 13-26 0-22-12-24-7-7 20 18 28 43 25 46-5zm-225-37c8-28-2-48-20-41-12 5-12 7-1 14 10 7 8 9-7 10-17 0-18 1-3 7 11 4 14 12 9 20-13 21-40 3-37-24 2-13 6-27 9-31 10-9 8-23-2-23s-27 39-23 54c2 5-4 6-13 3-8-4-15-2-15 4 0 5 13 15 30 20 16 6 27 15 24 20s6 4 20-2c13-6 27-20 29-31zm-319 10c-5-7-1-9 12-6 15 4 19-1 21-24 1-15-2-28-7-28-6 0-10 6-10 14 0 7-7 19-15 26-13 11-12 30 1 30 3 0 2-5-2-12zm805-14c-6-8-5-13 5-17 8-3 17-1 20 6 5 9 7 9 12-1 3-6 9-10 14-7 4 3 10-5 13-16 4-16 2-19-11-14-14 5-15 4-4-6 6-7 12-20 11-28 0-13-2-14-6-1-3 8-15 23-25 35-16 16-18 17-13 2 6-13 3-16-9-11-14 5-19 23-15 50 0 4-5 10-13 15-9 6-6 8 9 6 16-1 19-5 12-13zm-889 0c0-3-8-13-17-22-12-12-18-13-21-4-2 6-8 12-13 12-6 0-7-6-1-17 7-11 6-21-3-30-18-18-31-17-16 1 7 8 11 23 9 33-2 13 3 17 20 16 12-2 22 2 22 7 0 6 5 10 10 10 6 0 10-3 10-6zm835-5c4-5 0-18-8-27s-13-22-10-28c2-6-3-16-10-22-11-9-19-6-37 13-13 14-19 25-14 25s15-10 23-21c10-17 15-19 21-9 6 9 3 18-8 26-13 9-14 15-4 26 6 8 9 18 5 21-3 4 3 7 15 7 11 0 24-5 27-11zm35-29c0-5-5-10-11-10s-9-6-6-12c2-7 10-12 16-10 6 1 11-5 11-13 0-21-9-19-30 7-13 16-14 25-6 35 13 15 26 17 26 3zm-8e2-9c0-16-25-28-58-28-19 0-31 5-29 11s15 11 30 11c14 0 29 3 33 8 10 10 24 9 24-2zm854-45c-3-8 4-16 20-20 25-6 39-29 15-23-14 3-21-31-8-39 14-8 11-36-3-32-7 3-16 18-19 34-5 23-7 24-8 7 0-13-7-23-13-23-7 0 2-8 20-17 28-13 31-18 18-25-9-5-16-14-16-21s4-6 10 3c5 8 12 12 15 9 9-9-6-40-16-33-5 3-9 2-8-3 4-22-3-32-30-41-23-8-31-7-35 3-7 18 5 27 20 14 8-7 14-6 20 2 4 7 3 9-4 5-6-3-14-2-17 4-11 17-35-8-28-28 6-15 5-16-13-2-17 14-18 13-7-1 7-9 10-19 6-22-3-4-1-7 5-7 7 0 12 5 12 11 0 5 4 8 10 4 5-3 7-12 3-20-4-11-1-13 11-9 9 3 16 1 16-5 0-13-29-14-50-2-8 6-18 7-24 4-5-4-23-7-40-8s-25 0-18 2c6 3 12 9 12 15s-9 3-20-7-17-22-13-28 0-8-10-4-17 1-17-6c0-6-7-1-16 11-8 12-22 22-30 22-18 0-18 14 0 29 10 8 16 9 21 1 3-5 11-10 17-10s5 6-3 16c-7 9-14 35-15 57-3 34-1 38 6 20 5-13 17-23 27-24 10 0 27-2 37-4 11-2 28 1 39 7 16 8 17 12 6 20s-11 9 2 5c9-3 22 0 28 6 8 8 11 8 11 0 0-7-4-15-10-18-5-3-10-13-10-22 0-10 11-3 32 21l32 37 14-23c9-16 12-18 7-4-3 11 0 24 7 29 10 6 9 7-4 4-19-7-29 12-21 42 5 21-19 55-31 43-4-4-16 4-26 18-15 19-20 21-20 9 0-9 7-19 15-23 8-3 15-9 14-13-3-20 2-27 11-13 7 11 12 12 20 4s6-13-9-17c-22-5-61 33-61 60 0 17 30 30 39 16 3-5 16-12 28-15 16-4 20-2 16 10-4 10-2 13 5 8 6-3 13-2 17 4 9 15 15 12 9-4zm-958-11c-17-13-16-14 13-13 17 1 31 5 31 11 0 5 7 4 16-3 12-11 15-11 12 0-2 8 9 14 30 16 19 1 30-1 26-7-3-6-12-8-20-5s-14 1-14-3c0-5 6-11 12-13 9-3 7-13-7-34-11-16-20-32-20-36 0-17-20-7-20 10 0 9-4 23-8 30-5 6-5 16-2 22s-1 7-9 4c-9-3-13-11-9-18 4-6-1-5-10 3-14 11-17 11-17 0 0-8-7-4-16 9-17 25-11 42 14 42 15-1 15-2-2-15zm14-95c-21-14-30-12-30 4 0 18 22 27 35 14 6-6 5-12-5-18zm390 10c0-5 7-10 15-10s15-4 15-10c0-5-9-10-20-10s-20 2-20 4-3 11-6 20-1 16 5 16 11-4 11-10zm-344-55c-9-7-11-16-7-24 6-9 10-6 16 11 4 12 6 29 6 36-1 6 3 12 9 12 5 0 10-7 10-15s5-15 11-15c5 0 7-4 4-10-4-6 10-10 35-10 35 0 41-3 36-16-4-9-2-22 3-28 7-8 6-26-1-53-8-33-14-41-29-38-10 2-19 0-19-6 0-5-4-9-10-9-5 0-6 8-3 18 6 14 4 15-8 5s-15-7-17 14c-3 34-19 53-39 46-10-4-14-2-10 4s0 14-9 17-12 2-9-5c4-5 2-15-3-22-6-7-11-16-12-22 0-5-9-20-20-32-23-27-64-21-55 8 4 11 2 19-5 19-6 0-8 5-4 11 4 7 0 9-14 5-19-6-20-5-9 17 10 21 16 24 49 19 32-4 37-2 32 11-3 9-16 23-30 31-19 13-22 13-18 2 3-8 1-16-4-20-10-6-9 24 1 41 4 6 1 14-5 16-8 4-7 6 4 6 9 1 24 4 34 8 12 4 15 3 10-5-4-7-3-12 3-12 5 0 12 4 16 10 3 5 12 7 19 4 8-3 17 0 22 7 5 9 11 7 21-7 12-16 12-20-1-29zm624-15c-8-5-4-9 9-13 21-5 30-37 11-37-5 0-6 8-3 17 5 12 2 15-9 10-10-3-19 0-22 9-10 26-7 34 10 27 11-4 12-8 4-13zm-380 3c0-5-4-13-8-20-8-13-52-6-52 8s28 11 33-3c3-8 6-6 6 5 1 16 21 26 21 10zm716-19c-9-8-16-20-16-25s-7-9-15-9-15 5-15 10c0 6 5 10 10 10 6 0 10 7 10 15 0 9 9 15 21 15 19 0 19-1 5-16zm-366-30c0-8 4-13 9-9 6 3 9-4 8-15-1-23-17-28-17-5 0 8-7 15-15 15-9 0-12 6-9 15 8 20 24 19 24-1zm380-14c0-5-6-11-12-13-8-3-5-6 6-6 12-1 16-6 12-17s-2-15 8-11 13 1 9-9c-7-18-9-18-33 6-11 11-26 20-32 20-7 0-5-5 5-11 19-11 24-39 6-39-5 0-7 5-4 10 10 17-17 11-37-7-15-14-19-14-16-3 2 8 8 18 13 22 6 4 10 12 10 18s7 15 15 21c13 9 12 10-2 5-16-5-33 6-23 15 8 8 75 7 75-1zm-960-34c0-14-40-30-50-20-5 6 29 34 42 34 4 0 8-6 8-14zm775-45c3-5 1-12-4-15-5-4-12-2-16 4-4 7-12 7-25 0-16-8-18-8-14 5 7 16 49 21 59 6zm-196-107c18 12 13-1-13-28-23-25-56-35-56-17 0 17 45 60 51 49 4-6 12-7 18-4zm201-13c0-5-6-12-12-15-10-5-10-7 0-12 6-3 12-12 12-20s9-14 19-14c14 0 19-6 16-20-2-11 1-20 7-20 5 0 8 7 5 15-4 8-2 17 3 20 6 4 10 1 10-4 0-6 7-11 15-11s15 3 15 8c0 12-50 31-66 25-8-3-14 0-14 7 0 6 5 8 10 5 6-3 10-1 10 4 0 16 16 13 34-5 9-8 20-12 26-9 6 4 9 1 8-7-2-7 7-14 20-16 12-2 23-9 24-15 5-42 4-66-4-61-5 3-7-5-5-18 2-12 2-17 0-10-3 6-9 12-14 12-6 0-8-4-5-9 4-5-5-22-18-38-23-28-26-33-26-54 0-6-7-9-14-6-10 4-13 1-9-9s-3-14-25-14c-18 0-32-6-36-16-4-9-9-14-12-11-9 9 16 47 31 47 7 0 17 5 21 12 5 8 2 9-9 5s-17-1-17 8c0 8-5 15-11 15-12 0-38 29-39 43 0 17 18 5 24-15 7-22 7-22 15-3 10 24 2 35-28 38-13 1-27 9-32 19-7 13-6 16 4 12 8-3 17 2 21 11 3 9 10 14 15 11s12 1 15 9c3 9-1 18-9 21-8 4-15 15-15 25 0 13-5 17-17 12-15-5-16-4-5 8s17 9 39-16l26-30-20 35c-14 26-17 39-9 47 13 15 26 16 26 4zm203-27c-3-8 0-14 6-14s11-4 11-8c0-5-7-9-15-9s-13 3-10 5c3 3-3 11-13 19-9 8-11 11-3 7 10-5 13-3 8 9-4 11-2 14 8 11 8-3 11-12 8-20zm-1064 7c3-1-4-8-15-16-16-13-16-14-1-9 27 10 21-28-8-49-14-10-25-13-25-7 0 5-8 10-17 11-15 0-15 2 2 9 20 9 20 9 0 9-11 1-27 6-35 11-13 8-12 11 5 24 18 14 22 13 39-7 17-21 18-21 16-2-3 30-1 34 18 30 9-2 19-4 21-4zm977-8c-3-7-1-15 5-18 5-4 8-3 7 2-3 9 5 13 25 13 7 0 4-7-7-15-17-13-22-13-39 3-10 9-22 16-25 14-4-2-8 1-10 6-2 6 9 9 23 8 15 0 23-6 21-13zm-971-71c-12-10-25-26-29-37-6-14-10-16-13-7-6 15 47 76 56 66 3-3-3-13-14-22zm751-48c-3-8 0-11 10-7 15 6 20-12 5-21-10-6-25 10-34 36-4 12-2 15 9 11 8-3 13-12 10-19zm-35-41c0-16 1-16 8 1 5 14 10 16 15 7 10-16 4-22-27-25-19-2-23 1-19 16 6 23 22 24 23 1zm99-29c0-2-13-16-29-33-31-32-58-28-46 8 6 21 25 29 25 11 0-5-5-10-11-10-5 0-7-5-3-11 4-7 12-6 23 6 15 15 15 17-1 26-29 16-20 29 12 18 17-6 30-13 30-15zm-6e2 6c0-5-8-10-17-11-11 0-13-3-5-6 15-6 16-46 0-41-13 5-19 33-11 54 6 16 33 19 33 4zm630-42c0-6-11-26-25-44s-25-37-25-43c0-12 28-21 52-18 17 3 59 40 55 49-1 2 3 0 8-5 6-5 3-13-8-22-14-10-15-14-5-18s10-8-2-16c-13-9-13-11 2-11 24 0 31-16 7-17-18-2-23 7-20 36 2 7-3 10-9 6-7-4-9-19-5-37 5-21 4-28-4-24-6 4-11 0-11-8 0-18-16-21-25-6-3 6-1 10 5 10s9 4 6 9c-4 5 0 12 6 14 10 4 10 6 1 6-15 1-36-36-28-49 3-6 1-10-4-10-10 0-13 7-10 26 0 4-5 11-13 16-10 8-10 9 3 5 8-3 20 3 26 12 8 13 8 18 0 19-7 0-27 3-44 6-18 3-34 1-34-4-1-6-3-14-4-20-1-5-3-14-4-20 0-5-6-10-12-10s-8 7-5 17c4 9 1 21-6 26-10 6-9 8 3 4 13-4 15-1 12 14-5 17-2 19 20 14 30-8 48 13 23 27-9 5-14 14-10 19 4 6 10 6 19-1 9-8 17-3 31 17 10 16 17 31 16 36-1 4 3 7 8 7 6 0 10-5 10-12zm-6e2-92c0-14-7-31-15-40-8-8-12-22-8-31 5-15 3-15-16 1-18 16-19 20-6 22 12 3 15 10 11 28-8 29-1 44 20 44 8 0 14-10 14-24zm530-50c0-8 2-20 3-28 2-7 2-10 0-5-9 15-22 6-17-10 5-15 4-16-5-3-6 9-6 19-1 24 4 4 6 15 3 22-3 8 0 14 6 14s11-6 11-14z" id="path1"/><path d="m1669 1481c7-5 11-13 7-19-3-5 1-13 10-16 22-9 23-8 21 13 0 11-5 17-9 15-4-3-8 0-8 5 0 6-8 11-17 11-14 0-15-2-4-9z" id="path2"/><path d="m1883 1165c0-8 4-15 9-15 4 0 8-5 8-11s-7-8-16-5c-12 5-14 1-9-15 5-14 3-19-4-15-7 5-9 1-5-8 3-9 1-16-6-16-6 0-8-5-5-10 5-8 11-7 21 1 7 6 12 15 9 19s5 19 16 34c18 23 19 28 5 41-18 19-23 19-23 0z" id="path3"/><path d="m1853 1157c-4-8-19-14-33-13-20 1-24-3-22-19 3-20 2-20-13-1-8 11-15 15-15 10 0-6 6-16 13-23 10-11 7-12-13-6-24 7-24 7-5-9 11-8 25-16 31-16 7 0 14-9 17-20 6-25-1-26-19-2-13 16-14 16-11-3 1-11 5-20 7-21 3 0 16-6 29-13s21-8 17-3c-3 6-1 12 6 14 7 3 9 12 5 22-4 9-11 14-17 11-16-10-11 7 6 19 8 6 16 18 18 26s6 23 11 33c9 22 0 34-12 14z" id="path4"/><path d="m1385 1440c-4-6-11-8-16-5s-6-1-3-9c4-10 1-16-7-16-12 0-12-2 0-9 9-6 10-11 2-15-8-5-6-15 6-31 17-21 19-22 36-8 15 15 17 15 17-1 0-23 49-18 73 8 22 25 22 31-3 33-13 1-25-7-32-23-6-13-15-24-20-24-15 0-8 18 17 49 24 27 24 30 6 28-11 0-17-5-15-9 3-4 1-8-5-8-5 0-13 5-17 11-3 6-14 9-24 6-13-3-17 0-13 10 3 8 12 12 20 9s11-1 8 4c-8 13-22 13-30 0z" id="path5"/><path d="m1368 1285c-6-45 0-68 13-59 5 3 9 1 9-4s7-9 15-9c24 0 17 14-10 21-14 4-25 11-25 16 0 14 22 12 44-5 11-8 23-15 27-15 9 0 3 40-7 49-4 3-4-3 0-13 5-16 4-17-8-7-8 7-12 20-10 29 5 15 4 15-9 0-14-18-32-25-24-10 3 4 1 16-3 27-6 16-8 11-12-20z" id="path6"/><path d="m1219 1202c-13-15-20-24-15-20 5 5 20-9 33-30 15-23 22-28 18-14-4 12-2 22 3 22 15 0 33 48 20 56-7 4-8 3-4-4s2-12-3-12c-6 0-11-7-11-15s-7-15-15-15c-20 0-19 27 1 38 10 5 12 12 7 15-6 4-21-6-34-21z" id="path7"/><path d="m1451 1202c-1-7-5-11-10-8-5 4-12 0-15-6-5-10-7-10-12 0-3 6-10 12-16 12s-6-6 2-15c6-8 9-18 6-24-3-5 3-7 14-4s20 9 20 14c0 16 18 10 24-8 4-10 1-20-9-25-21-13-19-27 4-21 25 6 34 29 21 52-5 10-6 22-2 26 4 5 2 5-5 2-6-4-14-1-16 5-4 10-6 10-6 0z" id="path8"/><path d="m1318 1173c-10-2-18-11-18-19s-4-12-10-9-7-1-4-9c7-19 24-11 24 11 0 13 3 13 15 3 17-14 21-35 5-25-5 3-10 1-10-4 0-6 4-11 9-11 17 0 23 20 11 35-6 8-9 19-5 25 3 5 5 9 3 9-2-1-11-3-20-6z" id="path9"/><path d="m1420 957c-8-12-13-28-12-34 2-7-2-13-7-13-6 0-8-7-5-15 7-17 40-20 50-4 4 8 0 9-15 4-28-9-27 1 4 29 14 13 25 30 25 37-1 10-4 9-11-3-5-10-15-18-21-18-7 0-6 6 2 15 7 9 11 17 9 20-3 2-11-6-19-18z" id="path10"/><path d="m1024 962c4-7 1-12-6-12-8 0-6-5 5-11 20-12 23-35 5-43-7-3 0-3 17-1 16 3 32 0 36-6 3-6 8-2 11 9 4 12-2 29-13 40-10 11-15 23-11 28 4 4 1 4-5 0-7-4-13-14-13-22s-5-12-10-9c-6 4-8 10-5 15s0 12-6 16c-8 4-9 3-5-4z" id="path11"/></g></svg>
</span></span><span class=dark:text-neutral-300>On peut supprimer la r√®gle avec l&rsquo;option <code>-r</code> : <code>xdp-filter ip -m src -r 10.10.0.10</code></span></div><p>Avec cet exemple, il faut bien comprendre que les programmes XDP fonctionnent uniquement √† l&rsquo;arriv√©e de l&rsquo;interface (<em>ingress</em>). Ainsi l&rsquo;IP source est <code>10.0.0.10</code> et l&rsquo;IP destination est toujours <code>10.0.0.1</code>.</p><p>Si on avait voulu emp√™cher lb de pinger en cr√©ant un programme XDP sur l&rsquo;interface jumelle veth1, on aurait d√ª lancer la commande suivante :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>xdp-filter</span> ip <span class=na>-m</span> dst <span class=m>10</span>.<span class=m>0</span>.<span class=m>0</span>.<span class=m>10</span>
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="namepaces xdp" src=https://blog.littlejo.link/assets/svg/xdp/namespaces-xdp-ping-not-veth1.svg></figure></p><p>En effet, l&rsquo;ip source est maintenant l&rsquo;IP de l&rsquo;interface veth0 et l&rsquo;IP destination est l&rsquo;ip o√π envoie le <code>echo reply</code> c&rsquo;est √† dire <code>10.0.0.10</code>.</p><p>V√©rifiez tout de m√™me que le ping ne fonctionne plus :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>ip</span> netns <span class=nb>exec </span>lb ping <span class=na>-c</span> <span class=m>3</span> <span class=m>10</span>.<span class=m>0</span>.<span class=m>0</span>.<span class=m>1</span>
</span></span></code></pre></div><p>Mais qu&rsquo;on peut toujours pinger depuis un autre <em>namespace</em> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Fish data-lang=Fish><span class=line><span class=cl><span class=nf>ip</span> netns <span class=nb>exec </span>h2 ping <span class=na>-c</span> <span class=m>3</span> <span class=m>10</span>.<span class=m>0</span>.<span class=m>0</span>.<span class=m>1</span>
</span></span></code></pre></div><p>On peut le voir avec <code>xdp-filter status</code> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>CURRENT XDP-FILTER STATUS:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Aggregate per-action statistics:
</span></span><span class=line><span class=cl>  XDP_ABORTED                                   0 pkts           0 KiB
</span></span><span class="line hl"><span class=cl>  XDP_DROP                                      5 pkts           0 KiB
</span></span><span class=line><span class=cl>  XDP_PASS                                     16 pkts           1 KiB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Loaded on interfaces:
</span></span><span class=line><span class=cl>                                           Enabled features
</span></span><span class=line><span class=cl>xdpfilt_alw_all
</span></span><span class=line><span class=cl>  veth0 (native mode)                      tcp,udp,ipv6,ipv4,ethernet,allow
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Filtered ports:
</span></span><span class=line><span class=cl>                                           Mode             Hit counter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Filtered IP addresses:
</span></span><span class=line><span class=cl>                                           Mode             Hit counter
</span></span><span class="line hl"><span class=cl>  10.0.0.10                                src              5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Filtered MAC addresses:
</span></span><span class=line><span class=cl>                                           Mode             Hit counter
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md
alert-info"><span class="pe-3 flex items-center
alert-icon-info"><span class="relative block icon"><!doctype html><svg height="800" width="800" id="_x32_" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512"><style>.st0{fill:currentColor}</style><g><path class="st0" d="M485.235 281.91l-44.273-25.356-65.345 8.26c-1.168-4.886-2.55-9.608-4.173-14.099l46.634-18.049 27.349-47.596-2.954-23.279c18.874-15.396 31.677-45.767 16.762-78.388-18.024-39.422-54.964-47.27-54.964-47.27l2.07 70.755-56.364-28.259c-5.169 72.541 40.787 95.467 69.029 93.252l1.031 8.098-18.917 32.912-40.512 15.688c-13.516-20.728-36.811-43.303-38.589-58.287 5.144-4.336 8.407-10.82 8.407-18.075.0-13.051-10.578-23.631-23.63-23.631s-23.64 10.58-23.64 23.631c0 6.475 2.611 12.34 6.818 16.607-7.007 10.501-6.414 17.723-33.978 17.723-27.555.0-26.97-7.222-33.977-17.723 4.216-4.267 6.826-10.132 6.826-16.607.0-13.051-10.588-23.631-23.648-23.631-13.052.0-23.622 10.58-23.622 23.631.0 7.256 3.263 13.739 8.406 18.075-1.777 14.984-25.073 37.558-38.588 58.287l-40.521-15.688-18.9-32.912 1.022-8.098c28.242 2.215 74.198-20.711 69.021-93.252l-56.364 28.259 2.078-70.755s-36.948 7.849-54.963 47.27c-14.924 32.62-2.113 62.992 16.752 78.388l-2.954 23.279 27.348 47.596 46.635 18.049c-1.606 4.491-2.998 9.213-4.174 14.099l-65.336-8.26L26.756 281.91.0 327.935l15.353 10.158 28.671-37.773 32.088-18.376 56.596 7.162c-.293 4.259-.404 8.518-.301 12.786l-40.71 13.567L52.216 362.84l-6.414 60.279 18.195 2.868 11.42-52.628 30.672-36.811 29.478-9.832c2.216 9.223 5.634 17.929 10.45 25.64l-27.624 19.174-11.867 51.546 15.903 52.791 17.774-4.808-8.569-49.176 9.247-36.064 20.574-14.28c34.467 33.874 81.737 33.643 94.539 33.643 12.812.0 60.073.231 94.549-33.643l20.574 14.28 9.239 36.064-8.56 49.176 17.774 4.808 15.903-52.791-11.876-51.546-27.632-19.174c4.826-7.711 8.244-16.418 10.458-25.64l29.479 9.832 30.68 36.811 11.412 52.628 18.195-2.868-6.414-60.279-39.482-47.381-40.71-13.567c.112-4.267-.009-8.526-.292-12.786l56.595-7.162 32.081 18.376 28.67 37.773L512 327.935 485.235 281.91z"/></g></svg>
</span></span><span class=dark:text-neutral-300>Dans le prochain √©pisode, nous allons montrer comment recr√©er la commande <code>xdp-filter</code> avec Aya.</span></div><h3 class="relative group">Anatomie d&rsquo;un paquet r√©seau<div id=anatomie-dun-paquet-r√©seau class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#anatomie-dun-paquet-r%c3%a9seau aria-label=Ancre>#</a></span></h3><p>Maintenant qu&rsquo;on a r√©ussi √† cr√©er des programmes XDP avec <code>xdp-filter</code>, une autre difficult√© qui va appara√Ætre assez rapidement quand on va essayer de r√©ellement d√©velopper un programme XDP, c&rsquo;est les connaissances en r√©seau. Comme je l&rsquo;√©crivais au d√©but de l&rsquo;article, avec XDP on r√©cup√®re des donn√©es bruts du paquet, il faut r√©ussir √† l&rsquo;analyser en comprenant comment est architectur√© un paquet r√©seau.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=packet src=https://blog.littlejo.link/assets/svg/xdp/packet.svg></figure></p><p>Ainsi un paquet r√©seau a deux parties :</p><ul><li>Le messager (les en-t√™tes)¬†: les adresses IP, MAC, le protocole, le port utilis√©, etc. La partie int√©ressante pour l&rsquo;ing√©nieur r√©seau.</li><li>Le contenu du message (<em>payload</em>) : la partie int√©ressante pour l&rsquo;utilisateur.</li></ul><p>Comment sont structur√©s ses en-t√™tes¬†? Par les diff√©rentes couches du mod√®le TCP/IP. √áa vous dit quelques choses¬†? Moi j&rsquo;avais (presque) tout oubli√©.</p><h4 class="relative group">Mod√®le TCP/IP<div id=mod√®le-tcpip class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#mod%c3%a8le-tcpip aria-label=Ancre>#</a></span></h4><p>Le mod√®le TCP/IP a 4 couches :</p><ol><li>Acc√®s r√©seau : Filaire (Ethernet) ou sans fil (Wifi)</li><li>Internet : IPv4, IPv6, ICMP, etc</li><li>Transport : TCP et UDP</li><li>Application : HTTP, SSH, DNS, etc</li></ol><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=layers src=https://blog.littlejo.link/assets/svg/xdp/layers.svg></figure></p><p>XDP intervient d√®s la r√©ception de la couche 1. Le paquet encapsule les diff√©rentes couches. Ainsi le paquet sera structur√© de la mani√®re suivante :</p><ol><li>l&rsquo;en-t√™te acc√®s r√©seau (on verra uniquement l&rsquo;en-t√™te ethernet : <em>ethernet header</em>¬†(<em>ethhdr</em>)), il va permettre de savoir si on est en IPv4 ou en IPv6</li><li>l&rsquo;en-t√™te internet (par exemple : <em>internet protocol header</em>¬†(<em>iphdr</em>)), il va permettre de savoir si on est en <em>UDP</em>, <em>TCP</em> ou <em>ICMP</em></li><li>l&rsquo;en-t√™te transport (par exemple : <em>transmission control protocol header</em>¬†(<em>tcphdr</em>)), il va permettre de savoir sur quel port on est par exemple.</li><li>l&rsquo;en-t√™te applicative est beaucoup moins standard, nous n&rsquo;irons pas jusque l√†.</li></ol><p>Voici par exemple les diff√©rentes en-t√™tes pour une requ√™te DNS :</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=headers src=https://blog.littlejo.link/assets/svg/xdp/packet-headers.svg></figure></p><p>Ainsi pour cr√©er un programme XDP, il faut se balader sur les diff√©rentes en-t√™tes du paquet et r√©cup√©rer un √©l√©ment particulier de l&rsquo;en-t√™te.</p><p>L&rsquo;en-t√™te d&rsquo;UDP est compos√©e des √©l√©ments suivants :</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=udphdr src=https://blog.littlejo.link/assets/svg/xdp/packet-udphdr.svg></figure></p><ol><li>Port source : depuis quel port le paquet est envoy√© (un port variable d√©finit par l&rsquo;application)</li><li>Port destination : √† quel port le paquet doit √™tre envoy√© (par exemple le port 53 pour le DNS)</li><li>Longueur : longueur total du segment UDP (en-t√™te + payload)</li><li>Checksum : v√©rification de l&rsquo;int√©grit√© du paquet.</li></ol><p>Une fois qu&rsquo;on a r√©cup√©r√© l&rsquo;√©l√©ment cible, nous pourrons d√©cider par exemple si nous bloquons l&rsquo;acc√®s au paquet.</p><hr><p>Dans cet √©pisode, on a vu les bases d&rsquo;XDP : √† quoi cela sert, son histoire, qui l&rsquo;utilise et les pr√©-requis pour d√©buter un programme XDP.</p><p>Tout cela vous para√Æt abstrait ? Nous allons maintenant passer √† la pratique dans l&rsquo;√©pisode suivant : on va cr√©er un petit firewall XDP avec Aya !</p></div><details class="mt-2 mb-5 overflow-hidden rounded-lg ms-0 ps-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 -ms-5 ps-5 dark:bg-primary-800 dark:text-neutral-100">Apprenons XDP avec Aya -
Cet article fait partie d'une s√©rie.</summary><div class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">Partie 1:
Cet article</div><div class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><a href=/ebpf-another-type/xdp/example-1/>Partie 2:
Impl√©mentons un petit firewall avec XDP</a></div><div class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><a href=/ebpf-another-type/xdp/example-2-tr/>Partie 3:
Att√©nuons les attaques DDoS avec XDP</a></div></details><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.littlejo.link/ebpf-another-type/xdp/intro/&amp;title=XDP,%20le%20firewall%20ultra%20rapide%20de%20Linux" title="Poster sur LinkedIn" aria-label="Poster sur LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://bsky.app/intent/compose?text=XDP,%20le%20firewall%20ultra%20rapide%20de%20Linux+https://blog.littlejo.link/ebpf-another-type/xdp/intro/" title aria-label><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://s2f.kytta.dev/?text=XDP,%20le%20firewall%20ultra%20rapide%20de%20Linux%20https://blog.littlejo.link/ebpf-another-type/xdp/intro/" title aria-label><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://blog.littlejo.link/ebpf-another-type/xdp/intro/&amp;subject=XDP,%20le%20firewall%20ultra%20rapide%20de%20Linux" title="Envoyer par email" aria-label="Envoyer par email"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></section></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_ebpf-another-type/xdp/intro/index.md data-oid-likes=likes_ebpf-another-type/xdp/intro/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/ebpf-another-type/uprobe/example-3-tr/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Profilons un petit programme avec des uProbes
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-09-23T09:15:14+02:00>23 septembre 2025</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/ebpf-another-type/xdp/example-1/><span class=leading-6>Impl√©mentons un petit firewall avec XDP&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-10-29T10:49:51+01:00>29 octobre 2025</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-24 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Faire d√©filer jusqu'au bas de la page" title="Faire d√©filer jusqu'au bas de la page">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Joseph Ligier</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom):not(a > img)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://blog.littlejo.link/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Rechercher tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Fermer (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>